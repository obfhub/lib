if not memorystats then memorystats={} memorystats.cache=function(a)end memorystats.restore=function(a)end end
for i,v in pairs(({"Internal","HttpCache","Instances","Signals","Script","PhysicsCollision","PhysicsParts","GraphicsSolidModels","GraphicsMeshParts","GraphicsParticles","GraphicsParts","GraphicsSpatialHash","GraphicsTerrain","GraphicsTexture","GraphicsTextureCharacter","Sounds","StreamingSounds","TerrainVoxels","Gui","Animation","Navigation","GeometryCSG"})) do
    memorystats.cache(v)
end
if getgenv().Loaded then 
    getgenv().Library:Unload()
end 

getgenv().Loaded = true 

-- Variables 
    -- Services
    local InputService, HttpService, GuiService, RunService, Stats, CoreGui, TweenService, SoundService, Workspace, Players = cloneref(game:GetService("UserInputService")), cloneref(game:GetService("HttpService")), cloneref(game:GetService("GuiService")), cloneref(game:GetService("RunService")), cloneref(game:GetService("Stats")), gethui(), cloneref(game:GetService("TweenService")), cloneref(game:GetService("SoundService")), cloneref(game:GetService("Workspace")), cloneref(game:GetService("Players"))
    local Camera, lp, gui_offset = Workspace.CurrentCamera, Players.LocalPlayer, GuiService:GetGuiInset().Y
    local mouse = lp:GetMouse()

    -- Data types
    local vec2, vec3, dim2, dim, rect, dim_offset = Vector2.new, Vector3.new, UDim2.new, UDim.new, Rect.new, UDim2.fromOffset

    -- Extra data types
    local color, rgb, hex, hsv, rgbseq, rgbkey, numseq, numkey = Color3.new, Color3.fromRGB, Color3.fromHex, Color3.fromHSV, ColorSequence.new, ColorSequenceKeypoint.new, NumberSequence.new, NumberSequenceKeypoint.new
-- 

-- Library init
    getgenv().Library = {
        Directory = "theobfuscated",
        Folders = {
            "/fonts",
            "/configs",
        },
        Flags = {},
        ConfigFlags = {},
        Connections = {},   
        Notifications = {Notifs = {}},
        OpenElement = {}; -- type: table or userdata

        -- Keybind list registry: [Flag] = {Name, KeyLabel, ActiveRef}
        KeybindRegistry = {};
    }

    local themes = {
        preset = {
            accent = rgb(255, 0, 242),
            window_outline = rgb(0, 0, 0),
            inline = rgb(25, 27, 27),
            background = rgb(17, 19, 19),
            visible_backgrounds = rgb(20, 23, 22),
            text_color = rgb(221, 223, 222),
            glow = rgb(0, 0, 0),
            deselected = rgb(89, 91, 91),
        },
        utility = {},
        gradients = {
            Selected = {};
            Deselected = {};
        },
    }

    for theme,color in themes.preset do 
        themes.utility[theme] = {
            BackgroundColor3 = {}; 	
            TextColor3 = {};
            ImageColor3 = {};
            ScrollBarImageColor3 = {};
            Color = {};
        }
    end 

    local Keys = {
        [Enum.KeyCode.LeftShift] = "LS",
        [Enum.KeyCode.RightShift] = "RS",
        [Enum.KeyCode.LeftControl] = "LC",
        [Enum.KeyCode.RightControl] = "RC",
        [Enum.KeyCode.Insert] = "INS",
        [Enum.KeyCode.Backspace] = "BS",
        [Enum.KeyCode.Return] = "Ent",
        [Enum.KeyCode.LeftAlt] = "LA",
        [Enum.KeyCode.RightAlt] = "RA",
        [Enum.KeyCode.CapsLock] = "CAPS",
        [Enum.KeyCode.One] = "1",
        [Enum.KeyCode.Two] = "2",
        [Enum.KeyCode.Three] = "3",
        [Enum.KeyCode.Four] = "4",
        [Enum.KeyCode.Five] = "5",
        [Enum.KeyCode.Six] = "6",
        [Enum.KeyCode.Seven] = "7",
        [Enum.KeyCode.Eight] = "8",
        [Enum.KeyCode.Nine] = "9",
        [Enum.KeyCode.Zero] = "0",
        [Enum.KeyCode.KeypadOne] = "Num1",
        [Enum.KeyCode.KeypadTwo] = "Num2",
        [Enum.KeyCode.KeypadThree] = "Num3",
        [Enum.KeyCode.KeypadFour] = "Num4",
        [Enum.KeyCode.KeypadFive] = "Num5",
        [Enum.KeyCode.KeypadSix] = "Num6",
        [Enum.KeyCode.KeypadSeven] = "Num7",
        [Enum.KeyCode.KeypadEight] = "Num8",
        [Enum.KeyCode.KeypadNine] = "Num9",
        [Enum.KeyCode.KeypadZero] = "Num0",
        [Enum.KeyCode.Minus] = "-",
        [Enum.KeyCode.Equals] = "=",
        [Enum.KeyCode.Tilde] = "~",
        [Enum.KeyCode.LeftBracket] = "[",
        [Enum.KeyCode.RightBracket] = "]",
        [Enum.KeyCode.RightParenthesis] = ")",
        [Enum.KeyCode.LeftParenthesis] = "(",
        [Enum.KeyCode.Semicolon] = ",",
        [Enum.KeyCode.Quote] = "'",
        [Enum.KeyCode.BackSlash] = "\\",
        [Enum.KeyCode.Comma] = ",",
        [Enum.KeyCode.Period] = ".",
        [Enum.KeyCode.Slash] = "/",
        [Enum.KeyCode.Asterisk] = "*",
        [Enum.KeyCode.Plus] = "+",
        [Enum.KeyCode.Period] = ".",
        [Enum.KeyCode.Backquote] = "`",
        [Enum.UserInputType.MouseButton1] = "MB1",
        [Enum.UserInputType.MouseButton2] = "MB2",
        [Enum.UserInputType.MouseButton3] = "MB3",
        [Enum.KeyCode.Escape] = "ESC",
        [Enum.KeyCode.Space] = "SPC",
    }
    
    Library.__index = Library

    for _,path in Library.Folders do 
        makefolder(Library.Directory .. path)
    end

    local Flags = Library.Flags 
    local ConfigFlags = Library.ConfigFlags
    local Notifications = Library.Notifications 
--

-- Library functions 
    -- Misc functions
        function Library:GetTransparency(obj)
            if obj:IsA("Frame") then
                return {"BackgroundTransparency"}
            elseif obj:IsA("TextLabel") or obj:IsA("TextButton") then
                return { "TextTransparency", "BackgroundTransparency" }
            elseif obj:IsA("ImageLabel") or obj:IsA("ImageButton") then
                return { "BackgroundTransparency", "ImageTransparency" }
            elseif obj:IsA("ScrollingFrame") then
                return { "BackgroundTransparency", "ScrollBarImageTransparency" }
            elseif obj:IsA("TextBox") then
                return { "TextTransparency", "BackgroundTransparency" }
            elseif obj:IsA("UIStroke") then 
                return { "Transparency" }
            end
        
            return nil
        end

        function Library:Tween(Object, Properties, Info)
            local tween = TweenService:Create(Object, Info or TweenInfo.new(0.25, Enum.EasingStyle.Quint, Enum.EasingDirection.InOut, 0, false, 0), Properties)
            tween:Play()
            
            return tween
        end

        function Library:Fade(obj, prop, vis, speed)
            if not (obj and prop) then
                return
            end

            local OldTransparency = obj[prop]
            obj[prop] = vis and 1 or OldTransparency

            local Tween = Library:Tween(obj, { [prop] = vis and OldTransparency or 1 }, TweenInfo.new(speed or 0.25, Enum.EasingStyle.Quint, Enum.EasingDirection.InOut, 0, false, 0))

            Library:Connection(Tween.Completed, function()
                if not vis then
                    task.wait()
                    obj[prop] = OldTransparency
                end
            end)

            return Tween
        end

        function Library:Resizify(Parent)
            local Resizing = Library:Create("TextButton", {
                Position = dim2(1, -10, 1, -10);
                BorderColor3 = rgb(0, 0, 0);
                Size = dim2(0, 10, 0, 10);
                BorderSizePixel = 0;
                BackgroundColor3 = rgb(255, 255, 255);
                Parent = Parent;
                BackgroundTransparency = 1; 
                Text = ""
            })
        
            local IsResizing = false 
            local Size 
            local InputLost 
            local ParentSize = Parent.Size  
            
            Resizing.InputBegan:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 then
                    IsResizing = true
                    InputLost = input.Position
                    Size = Parent.Size
                end
            end)
        
            Resizing.InputEnded:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 then
                    IsResizing = false
                end
            end)
        
            Library:Connection(InputService.InputChanged, function(input, game_event) 
                if IsResizing and input.UserInputType == Enum.UserInputType.MouseMovement then            
                    Parent.Size = dim2(
                        Size.X.Scale,
                        math.clamp(Size.X.Offset + (input.Position.X - InputLost.X), ParentSize.X.Offset, Camera.ViewportSize.X), 
                        Size.Y.Scale, 
                        math.clamp(Size.Y.Offset + (input.Position.Y - InputLost.Y), ParentSize.Y.Offset, Camera.ViewportSize.Y)
                    )
                end
            end)
        end
        
        function Library:Hovering(Object)
            if type(Object) == "table" then 
                local Pass = false;

                for _,obj in Object do 
                    if Library:Hovering(obj) then 
                        Pass = true
                        return Pass
                    end 
                end 
            else 
                local y_cond = Object.AbsolutePosition.Y <= mouse.Y and mouse.Y <= Object.AbsolutePosition.Y + Object.AbsoluteSize.Y
                local x_cond = Object.AbsolutePosition.X <= mouse.X and mouse.X <= Object.AbsolutePosition.X + Object.AbsoluteSize.X
    
                return (y_cond and x_cond)
            end 
        end  

        function Library:Draggify(Parent)
            local Dragging = false 
            local IntialSize = Parent.Position
            local InitialPosition 

            Parent.InputBegan:Connect(function(Input)
                if Input.UserInputType == Enum.UserInputType.MouseButton1 then
                    Dragging = true
                    InitialPosition = Input.Position
                    InitialSize = Parent.Position
                end
            end)

            Parent.InputEnded:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 then
                    Dragging = false
                end
            end)

            Library:Connection(InputService.InputChanged, function(Input, game_event) 
                if Dragging and Input.UserInputType == Enum.UserInputType.MouseMovement then
                    local Horizontal = Camera.ViewportSize.X
                    local Vertical = Camera.ViewportSize.Y

                    local NewPosition = dim2(
                        0,
                        math.clamp(
                            InitialSize.X.Offset + (Input.Position.X - InitialPosition.X),
                            0,
                            Horizontal - Parent.Size.X.Offset
                        ),
                        0,
                        math.clamp(
                            InitialSize.Y.Offset + (Input.Position.Y - InitialPosition.Y),
                            0,
                            Vertical - Parent.Size.Y.Offset
                        )
                    )

                    Parent.Position = NewPosition
                end
            end)
        end 

        -- =========================
        -- Watermark
        -- =========================
        function Library:InitWatermark()
            if self.WatermarkGui then
                self.WatermarkGui:Destroy()
                self.WatermarkGui = nil
            end

            local wmGui = Instance.new("ScreenGui")
            wmGui.Name = "theobfuscated_Watermark"
            wmGui.IgnoreGuiInset = true
            wmGui.ResetOnSpawn = false
            wmGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
            wmGui.DisplayOrder = 999999
            wmGui.Parent = CoreGui

            local holder = Instance.new("Frame")
            holder.Name = "Holder"
            holder.Size = UDim2.new(0, 0, 0, 24)
            holder.AutomaticSize = Enum.AutomaticSize.X
            holder.Position = UDim2.new(0, 10, 0, 10)
            holder.BackgroundColor3 = Color3.fromRGB(17, 19, 19)
            holder.BackgroundTransparency = 0
            holder.BorderSizePixel = 0
            holder.ClipsDescendants = false
            holder.Parent = wmGui

            local wmStroke = Instance.new("UIStroke")
            wmStroke.Thickness = 1
            wmStroke.Transparency = 0
            wmStroke.Color = Color3.fromRGB(255, 0, 242)
            wmStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
            wmStroke.Parent = holder

            local accentBar = Instance.new("Frame")
            accentBar.Name = "AccentBar"
            accentBar.Size = UDim2.new(0, 2, 1, 0)
            accentBar.Position = UDim2.new(0, 0, 0, 0)
            accentBar.BackgroundColor3 = Color3.fromRGB(255, 0, 242)
            accentBar.BorderSizePixel = 0
            accentBar.ZIndex = 2
            accentBar.Parent = holder

            local wmPad = Instance.new("UIPadding")
            wmPad.PaddingLeft  = UDim.new(0, 8)
            wmPad.PaddingRight = UDim.new(0, 8)
            wmPad.PaddingTop   = UDim.new(0, 0)
            wmPad.PaddingBottom = UDim.new(0, 0)
            wmPad.Parent = holder

            local label = Instance.new("TextLabel")
            label.Name = "Label"
            label.BackgroundTransparency = 1
            label.Size = UDim2.new(0, 0, 1, 0)
            label.AutomaticSize = Enum.AutomaticSize.X
            label.Position = UDim2.new(0, 0, 0, 0)
            label.TextXAlignment = Enum.TextXAlignment.Left
            label.TextYAlignment = Enum.TextYAlignment.Center
            label.Font = Enum.Font.Code
            label.TextSize = 13
            label.RichText = true
            label.TextColor3 = Color3.fromRGB(221, 223, 222)
            label.Text = '<font color="rgb(255,0,242)">ObfHub</font>  <font color="rgb(89,91,91)">|</font>  theobfuscated'
            label.Parent = holder

            self.WatermarkGui = wmGui
            self.WatermarkHolder = holder
            self.WatermarkLabel = label
            self.WatermarkStroke = wmStroke

            self:Draggify(holder)
            self:SetWatermarkVisible(true)
        end

        function Library:SetWatermarkVisible(state)
            self.WatermarkEnabled = (state == true)
            if self.WatermarkGui then
                self.WatermarkGui.Enabled = self.WatermarkEnabled
            end
        end

        function Library:SetWatermarkText(text)
            if self.WatermarkLabel then
                local parts = {}
                for segment in tostring(text):gmatch("[^|]+") do
                    table.insert(parts, segment:match("^%s*(.-)%s*$"))
                end
                if #parts >= 3 then
                    self.WatermarkLabel.Text = string.format(
                        '<font color="rgb(255,0,242)">%s</font>  <font color="rgb(89,91,91)">|</font>  <font color="rgb(221,223,222)">%s</font>  <font color="rgb(89,91,91)">|</font>  <font color="rgb(255,200,50)">%s</font>',
                        parts[1], parts[2], parts[3]
                    )
                elseif #parts == 2 then
                    self.WatermarkLabel.Text = string.format(
                        '<font color="rgb(255,0,242)">%s</font>  <font color="rgb(89,91,91)">|</font>  <font color="rgb(221,223,222)">%s</font>',
                        parts[1], parts[2]
                    )
                else
                    self.WatermarkLabel.Text = '<font color="rgb(221,223,222)">' .. tostring(text) .. '</font>'
                end
            end
        end

        -- =========================
        -- Keybind List
        -- =========================
        function Library:InitKeybindList()
            if self.KeybindListGui then
                self.KeybindListGui:Destroy()
                self.KeybindListGui = nil
            end

            local kbGui = Instance.new("ScreenGui")
            kbGui.Name = "theobfuscated_KeybindList"
            kbGui.IgnoreGuiInset = true
            kbGui.ResetOnSpawn = false
            kbGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
            kbGui.DisplayOrder = 999998
            kbGui.Enabled = true
            kbGui.Parent = CoreGui

            local holder = Instance.new("Frame")
            holder.Name = "KeybindListHolder"
            holder.AutomaticSize = Enum.AutomaticSize.Y
            holder.Size = UDim2.new(0, 220, 0, 0)
            holder.AnchorPoint = Vector2.new(0, 0)
            holder.Position = UDim2.fromOffset(10, 200)
            holder.BackgroundColor3 = rgb(17, 19, 19)
            holder.BackgroundTransparency = 0
            holder.BorderSizePixel = 0
            holder.ClipsDescendants = true
            holder.Parent = kbGui

            local holderStroke = Instance.new("UIStroke")
            holderStroke.Thickness = 1
            holderStroke.Color = rgb(255, 0, 242)
            holderStroke.Transparency = 0
            holderStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
            holderStroke.Parent = holder

            local accentBar = Instance.new("Frame")
            accentBar.Size = UDim2.new(0, 2, 1, 0)
            accentBar.Position = UDim2.new(0, 0, 0, 0)
            accentBar.BackgroundColor3 = rgb(255, 0, 242)
            accentBar.BorderSizePixel = 0
            accentBar.ZIndex = 5
            accentBar.Parent = holder

            do
                local starFrame = Instance.new("Frame")
                starFrame.Name = "Stars"
                starFrame.BackgroundTransparency = 1
                starFrame.Size = UDim2.new(1, 0, 1, 0)
                starFrame.Position = UDim2.new(0, 0, 0, 0)
                starFrame.ZIndex = 1
                starFrame.BorderSizePixel = 0
                starFrame.Parent = holder

                local STAR_COUNT   = 55
                local COLOR        = rgb(255, 0, 242)
                local rng          = Random.new()
                local stars        = {}

                for i = 1, STAR_COUNT do
                    local sz        = rng:NextInteger(1, 2)
                    local dot       = Instance.new("Frame")
                    dot.Name        = "\0"
                    dot.Size        = UDim2.new(0, sz, 0, sz)
                    dot.Position    = UDim2.new(rng:NextNumber(0,1), 0, rng:NextNumber(0,1), 0)
                    dot.BorderSizePixel = 0
                    dot.BackgroundColor3 = COLOR
                    dot.ZIndex      = 1
                    dot.Parent      = starFrame
                    local dc = Instance.new("UICorner")
                    dc.CornerRadius = UDim.new(0, 999)
                    dc.Parent = dot

                    stars[i] = {
                        dot      = dot;
                        speed    = rng:NextNumber(8, 24);
                        baseAlpha= rng:NextNumber(0.10, 0.65);
                        phase    = rng:NextNumber(0, math.pi * 2);
                    }
                end

                local st = 0
                self:Connection(RunService.RenderStepped, function(dt)
                    if not starFrame or not starFrame.Parent then return end
                    st += dt
                    local abs = starFrame.AbsoluteSize
                    if abs.X <= 0 or abs.Y <= 0 then return end
                    for _, s in stars do
                        local p  = s.dot.Position
                        local nx = p.X.Scale + (s.speed * dt) / abs.X
                        local ny = p.Y.Scale + (s.speed * dt) / abs.Y
                        if nx > 1.02 then nx = -0.02 end
                        if ny > 1.02 then ny = -0.02 end
                        s.dot.Position = UDim2.new(nx, 0, ny, 0)
                        local tw = math.sin(st * 2.2 + s.phase) * 0.5 + 0.5
                        s.dot.BackgroundTransparency = 1 - math.clamp(s.baseAlpha * (0.55 + 0.45 * tw), 0, 1)
                    end
                end)
            end

            local dragHandle = Instance.new("TextButton")
            dragHandle.Name = "Header"
            dragHandle.BackgroundColor3 = rgb(17, 19, 19)
            dragHandle.BackgroundTransparency = 0.3
            dragHandle.Size = UDim2.new(1, 0, 0, 24)
            dragHandle.Position = UDim2.new(0, 0, 0, 0)
            dragHandle.Font = Enum.Font.Code
            dragHandle.TextSize = 12
            dragHandle.TextColor3 = rgb(255, 255, 255)
            dragHandle.Text = "KEYBINDS"
            dragHandle.TextXAlignment = Enum.TextXAlignment.Center
            dragHandle.AutoButtonColor = false
            dragHandle.ZIndex = 6
            dragHandle.Parent = holder

            local sep = Instance.new("Frame")
            sep.Name = "Sep"
            sep.Size = UDim2.new(1, -6, 0, 1)
            sep.Position = UDim2.new(0, 3, 0, 24)
            sep.BackgroundColor3 = rgb(255, 0, 242)
            sep.BackgroundTransparency = 0.65
            sep.BorderSizePixel = 0
            sep.ZIndex = 6
            sep.Parent = holder

            local rowScroll = Instance.new("ScrollingFrame")
            rowScroll.Name = "Rows"
            rowScroll.Position = UDim2.new(0, 0, 0, 27)
            rowScroll.Size = UDim2.new(1, 0, 0, 0)
            rowScroll.AutomaticSize = Enum.AutomaticSize.Y
            rowScroll.AutomaticCanvasSize = Enum.AutomaticSize.Y
            rowScroll.CanvasSize = UDim2.new(0, 0, 0, 0)
            rowScroll.ScrollBarThickness = 0
            rowScroll.BackgroundTransparency = 1
            rowScroll.BorderSizePixel = 0
            rowScroll.ZIndex = 6
            rowScroll.Parent = holder

            local rowLayout = Instance.new("UIListLayout")
            rowLayout.SortOrder = Enum.SortOrder.LayoutOrder
            rowLayout.Padding = UDim.new(0, 0)
            rowLayout.Parent = rowScroll

            local rowPad = Instance.new("UIPadding")
            rowPad.PaddingBottom = UDim.new(0, 5)
            rowPad.Parent = rowScroll

            self.KeybindListGui     = kbGui
            self.KeybindListHolder  = holder
            self.KeybindListRows    = rowScroll
            self.KeybindListEnabled = true
            self.KeybindRowMap      = {}

            local dragging = false
            local initialPosition
            local initialSize

            local centred = false
            self:Connection(RunService.RenderStepped, function()
                if not centred and holder.AbsoluteSize.Y > 0 then
                    centred = true
                    local vp = Camera.ViewportSize
                    holder.Position = UDim2.fromOffset(10, math.clamp((vp.Y - holder.AbsoluteSize.Y) / 2, 0, vp.Y))
                end
            end)

            dragHandle.InputBegan:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 then
                    dragging = true
                    initialPosition = input.Position
                    initialSize = holder.Position
                end
            end)

            dragHandle.InputEnded:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 then
                    dragging = false
                end
            end)

            self:Connection(InputService.InputChanged, function(input)
                if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
                    local Horizontal = Camera.ViewportSize.X
                    local Vertical = Camera.ViewportSize.Y
                    holder.Position = dim2(
                        0,
                        math.clamp(
                            initialSize.X.Offset + (input.Position.X - initialPosition.X),
                            0,
                            Horizontal - holder.Size.X.Offset
                        ),
                        0,
                        math.clamp(
                            initialSize.Y.Offset + (input.Position.Y - initialPosition.Y),
                            0,
                            Vertical - holder.Size.Y.Offset
                        )
                    )
                end
            end)
        end

        function Library:RegisterKeybindRow(flag, name, keyText, isActive)
            if not self.KeybindListRows then return end

            local existingRow = self.KeybindRowMap and self.KeybindRowMap[flag]

            if existingRow then
                if existingRow.keyLabel then
                    existingRow.keyLabel.Text = "[" .. (keyText or "?") .. "]"
                end
                if existingRow.dot then
                    Library:Tween(existingRow.dot, {
                        BackgroundColor3 = isActive and rgb(255, 0, 242) or rgb(89, 91, 91)
                    })
                end
                if existingRow.nameLabel then
                    Library:Tween(existingRow.nameLabel, {
                        TextColor3 = isActive and rgb(221, 223, 222) or rgb(89, 91, 91)
                    })
                end
                return
            end

            local row = Instance.new("Frame")
            row.Name = flag
            row.BackgroundTransparency = 1
            row.Size = UDim2.new(1, 0, 0, 20)
            row.BorderSizePixel = 0
            row.ZIndex = 4
            row.Parent = self.KeybindListRows

            local dot = Instance.new("Frame")
            dot.Name = "Dot"
            dot.AnchorPoint = Vector2.new(0, 0.5)
            dot.Position = UDim2.new(0, 10, 0.5, 0)
            dot.Size = UDim2.new(0, 5, 0, 5)
            dot.BackgroundColor3 = isActive and rgb(255, 0, 242) or rgb(89, 91, 91)
            dot.BorderSizePixel = 0
            dot.ZIndex = 4
            dot.Parent = row
            local dotCorner = Instance.new("UICorner")
            dotCorner.CornerRadius = UDim.new(0, 999)
            dotCorner.Parent = dot

            local nameLabel = Instance.new("TextLabel")
            nameLabel.Name = "NameLabel"
            nameLabel.BackgroundTransparency = 1
            nameLabel.AnchorPoint = Vector2.new(0, 0.5)
            nameLabel.Position = UDim2.new(0, 20, 0.5, 0)
            nameLabel.Size = UDim2.new(1, -60, 1, 0)
            nameLabel.Font = Enum.Font.Code
            nameLabel.TextSize = 12
            nameLabel.TextColor3 = isActive and rgb(221, 223, 222) or rgb(89, 91, 91)
            nameLabel.Text = name or flag
            nameLabel.TextXAlignment = Enum.TextXAlignment.Left
            nameLabel.TextTruncate = Enum.TextTruncate.AtEnd
            nameLabel.ZIndex = 4
            nameLabel.Parent = row

            local keyLabel = Instance.new("TextLabel")
            keyLabel.Name = "KeyLabel"
            keyLabel.BackgroundTransparency = 1
            keyLabel.AnchorPoint = Vector2.new(1, 0.5)
            keyLabel.Position = UDim2.new(1, -8, 0.5, 0)
            keyLabel.Size = UDim2.new(0, 46, 1, 0)
            keyLabel.Font = Enum.Font.Code
            keyLabel.TextSize = 11
            keyLabel.TextColor3 = rgb(255, 0, 242)
            keyLabel.Text = "[" .. (keyText or "?") .. "]"
            keyLabel.TextXAlignment = Enum.TextXAlignment.Right
            keyLabel.ZIndex = 4
            keyLabel.Parent = row

            self.KeybindRowMap[flag] = {
                row = row;
                dot = dot;
                nameLabel = nameLabel;
                keyLabel = keyLabel;
            }
        end

        function Library:RemoveKeybindRow(flag)
            if not (self.KeybindRowMap and self.KeybindRowMap[flag]) then return end
            local entry = self.KeybindRowMap[flag]
            if entry.row then entry.row:Destroy() end
            self.KeybindRowMap[flag] = nil
        end

        function Library:SetKeybindListVisible(state)
            self.KeybindListEnabled = (state == true)
            if self.KeybindListGui then
                self.KeybindListGui.Enabled = self.KeybindListEnabled
            end
        end

        function Library:Convert(str)
            local Values = {}

            for Value in string.gmatch(str, "[^,]+") do
                table.insert(Values, tonumber(Value))
            end

            if #Values == 4 then              
                return unpack(Values)
            else
                return
            end
        end
        
        function Library:Lerp(start, finish, t)
            t = t or 1 / 8
            return start * (1 - t) + finish * t
        end

        function Library:ConvertEnum(enum)
            local EnumParts = {}
            
            for part in string.gmatch(tostring(enum), "[%w_]+") do
                table.insert(EnumParts, part)
            end
        
            local EnumTable = Enum

            for i = 2, #EnumParts do
                local EnumItem = EnumTable[EnumParts[i]]
                if not EnumItem then return nil end
                EnumTable = EnumItem
            end
            
            return EnumTable
        end

        function Library:ConvertHex(color, alpha)
            local r = math.floor(color.R * 255)
            local g = math.floor(color.G * 255)
            local b = math.floor(color.B * 255)
            local a = alpha and math.floor(alpha * 255) or 255
            return string.format("#%02X%02X%02X%02X", r, g, b, a)
        end

        function Library:ConvertFromHex(color)
            color = color:gsub("#", "")
            local r = tonumber(color:sub(1, 2), 16) / 255
            local g = tonumber(color:sub(3, 4), 16) / 255
            local b = tonumber(color:sub(5, 6), 16) / 255
            local a = tonumber(color:sub(7, 8), 16) and tonumber(color:sub(7, 8), 16) / 255 or 1
            return Color3.new(r, g, b), a
        end

        -- Stars background
        function Library:AddStars(Parent, opts)
            opts = opts or {}
            local STAR_COUNT     = opts.Count or 90
            local MIN_SIZE       = opts.MinSize or 1
            local MAX_SIZE       = opts.MaxSize or 2
            local MIN_SPEED      = opts.MinSpeed or 6
            local MAX_SPEED      = opts.MaxSpeed or 22
            local MIN_ALPHA      = opts.MinAlpha or 0.15
            local MAX_ALPHA      = opts.MaxAlpha or 0.75
            local TWINKLE_SPEED  = opts.TwinkleSpeed or 2.0
            local COLOR          = opts.Color or Color3.fromRGB(255, 0, 242)

            local Stars = self:Create("Frame", {
                Name = "\0";
                Parent = Parent;
                BackgroundTransparency = 1;
                Size = UDim2.new(1, 0, 1, 0);
                Position = UDim2.new(0, 0, 0, 0);
                ClipsDescendants = true;
                ZIndex = 999;
            })

            local layout = Parent:FindFirstChildWhichIsA("UIListLayout")
            if layout then Stars.ZIndex = 1 end

            local stars = {}
            local rng = Random.new()

            local function newStar(i)
                local sz = rng:NextInteger(MIN_SIZE, MAX_SIZE)
                local x = rng:NextNumber(0, 1)
                local y = rng:NextNumber(0, 1)
                local speed = rng:NextNumber(MIN_SPEED, MAX_SPEED)
                local alpha = rng:NextNumber(MIN_ALPHA, MAX_ALPHA)
                local twkPhase = rng:NextNumber(0, math.pi * 2)

                local dot = self:Create("Frame", {
                    Name = "\0";
                    Parent = Stars;
                    Size = UDim2.new(0, sz, 0, sz);
                    Position = UDim2.new(x, 0, y, 0);
                    BorderSizePixel = 0;
                    BackgroundColor3 = COLOR;
                    BackgroundTransparency = 1 - alpha;
                    ZIndex = 1;
                })

                self:Create("UICorner", {
                    Parent = dot;
                    CornerRadius = UDim.new(0, 999);
                })

                stars[i] = {
                    dot = dot;
                    speed = speed;
                    baseAlpha = alpha;
                    twkPhase = twkPhase;
                }
            end

            for i = 1, STAR_COUNT do
                newStar(i)
            end

            local t = 0
            local function step(dt)
                if not Stars or not Stars.Parent then return end
                t += dt

                local abs = Stars.AbsoluteSize
                if abs.X <= 0 or abs.Y <= 0 then return end

                for i = 1, #stars do
                    local s = stars[i]
                    local dot = s.dot
                    if dot and dot.Parent then
                        local p = dot.Position
                        local nx = p.X.Scale
                        local ny = p.Y.Scale

                        nx += (s.speed * dt) / abs.X
                        ny += (s.speed * dt) / abs.Y

                        if nx > 1.02 then nx = -0.02 end
                        if ny > 1.02 then ny = -0.02 end

                        dot.Position = UDim2.new(nx, 0, ny, 0)

                        local tw = (math.sin(t * TWINKLE_SPEED + s.twkPhase) * 0.5 + 0.5)
                        local alpha = s.baseAlpha * (0.55 + 0.45 * tw)
                        dot.BackgroundTransparency = 1 - math.clamp(alpha, 0, 1)
                    end
                end
            end

            self:Connection(RunService.RenderStepped, step)
            return Stars
        end

        function Library:Keypicker(properties) 
            local Cfg = {
                Name = properties.Name or "Color", 
                Flag = properties.Flag or properties.Name or "Colorpicker",
                Callback = properties.Callback or function() end,

                Color = properties.Color or color(1, 1, 1),
                Alpha = properties.Alpha or properties.Transparency or 0,
                
                Mode = properties.Mode or "Keypicker";

                Open = false, 
                Items = {};
            }

            local DraggingSat = false 
            local DraggingHue = false 
            local DraggingAlpha = false 

            local h, s, v = Cfg.Color:ToHSV() 
            local a = Cfg.Alpha 

            Flags[Cfg.Flag] = {Color = Cfg.Color, Transparency = Cfg.Alpha}

            local Items = Cfg.Items; do 
                Items.Button = Library:Create( "TextButton" , {
                    Active = false;
                    BorderColor3 = rgb(0, 0, 0);
                    Text = "";
                    AutoButtonColor = false;
                    Name = "\0";
                    LayoutOrder = -1;
                    Parent = self.Items.Components;
                    Size = dim2(0, 28, 0, 14);
                    Selectable = false;
                    BorderSizePixel = 0;
                    BackgroundColor3 = rgb(26, 28, 28)
                });
                
                Items.ButtonColor = Library:Create( "Frame" , {
                    Parent = Items.Button;
                    Name = "\0";
                    Position = dim2(0, 1, 0, 1);
                    BorderColor3 = rgb(0, 0, 0);
                    Size = dim2(1, -2, 1, -2);
                    BorderSizePixel = 0;
                    BackgroundColor3 = rgb(119, 180, 91)
                });
                
                Library:Create( "UICorner" , {
                    Parent = Items.ButtonColor;
                    CornerRadius = dim(0, 4)
                });
                
                Library:Create( "UICorner" , {
                    Parent = Items.Button;
                    CornerRadius = dim(0, 4)
                });

                Items.Window = Library:Create( "TextButton" , {
                    Parent = Library.Other;
                    Text = "";
                    AutoButtonColor = false;
                    Active = false;
                    Name = "\0";
                    Position = dim2(0, 100, 0, 10);
                    BorderColor3 = rgb(0, 0, 0);
                    Size = dim2(0, 230, 0, 200);
                    BorderSizePixel = 0;
                    BackgroundColor3 = themes.preset.inline
                });	Library:Themify(Items.Window, "inline", "BackgroundColor3")

                Items.Fade = Library:Create( "Frame" , {
                    Parent = Items.Window;
                    BackgroundTransparency = 1;
                    ZIndex = 500;
                    Name = "\0";
                    Position = dim2(0, 0, 0, 0);
                    BorderColor3 = rgb(0, 0, 0);
                    Size = dim2(1, 0, 1, 0);
                    BorderSizePixel = 0;
                    BackgroundColor3 = themes.preset.inline
                });	Library:Themify(Items.Window, "inline", "BackgroundColor3")

                Library:Create( "UICorner" , {
                    Parent = Items.Window
                });                    

                Items.Inline = Library:Create( "Frame" , {
                    Parent = Items.Window;
                    Name = "\0";
                    Position = dim2(0, 1, 0, 1);
                    BorderColor3 = rgb(0, 0, 0);
                    Size = dim2(1, -2, 1, -2);
                    BorderSizePixel = 0;
                    BackgroundColor3 = themes.preset.visible_backgrounds
                });	Library:Themify(Items.Inline, "visible_backgrounds", "BackgroundColor3")
                
                Library:Create( "UICorner" , {
                    Parent = Items.Inline
                });                    

                Items.Fill = Library:Create( "Frame" , {
                    Parent = Items.Inline;
                    Name = "\0";
                    Position = dim2(0, 1, 0, 26);
                    BorderColor3 = rgb(0, 0, 0);
                    Size = dim2(1, -2, 0, 1);
                    BorderSizePixel = 0;
                    BackgroundColor3 = themes.preset.inline
                });	Library:Themify(Items.Fill, "inline", "BackgroundColor3")
                
                Items.Pallete = Library:Create( "Frame" , {
                    Parent = Items.Inline;
                    Name = "\0";
                    BackgroundTransparency = 1;
                    Position = dim2(0, 1, 0, 2);
                    BorderColor3 = rgb(0, 0, 0);
                    Size = dim2(1, -4, 1, -3);
                    BorderSizePixel = 0;
                    BackgroundColor3 = rgb(40, 40, 40)
                });
                
                Items.Outline = Library:Create( "Frame" , {
                    Name = "\0";
                    Parent = Items.Pallete;
                    BorderColor3 = rgb(0, 0, 0);
                    Size = dim2(1, -38, 1, -43);
                    BorderSizePixel = 0;
                    BackgroundColor3 = rgb(0, 0, 0)
                });
                
                Items.Inline = Library:Create( "Frame" , {
                    Parent = Items.Outline;
                    Name = "\0";
                    Position = dim2(0, 1, 0, 1);
                    BorderColor3 = rgb(0, 0, 0);
                    Size = dim2(1, -2, 1, -2);
                    BorderSizePixel = 0;
                    BackgroundColor3 = themes.preset.inline
                });	Library:Themify(Items.Inline, "inline", "BackgroundColor3")
                
                Items.Inner = Library:Create( "Frame" , {
                    Parent = Items.Inline;
                    Name = "\0";
                    Position = dim2(0, 1, 0, 1);
                    BorderColor3 = rgb(0, 0, 0);
                    Size = dim2(1, -2, 1, -2);
                    BorderSizePixel = 0;
                    BackgroundColor3 = rgb(0, 221, 255)
                });
                
                Items.Val = Library:Create( "TextButton" , {
                    Name = "\0";
                    Text = "";
                    AutoButtonColor = false;
                    Parent = Items.Inner;
                    BorderColor3 = rgb(0, 0, 0);
                    Size = dim2(1, 0, 1, 0);
                    BorderSizePixel = 0;
                    BackgroundColor3 = rgb(255, 255, 255)
                });
                
                Library:Create( "UIGradient" , {
                    Parent = Items.Val;
                    Transparency = numseq{numkey(0, 0), numkey(1, 1)}
                });
                
                Items.SatValPicker = Library:Create( "Frame" , {
                    Name = "\0";
                    Parent = Items.Inner;
                    BorderColor3 = rgb(0, 0, 0);
                    Size = dim2(0, 3, 0, 3);
                    BorderSizePixel = 0;
                    BackgroundColor3 = rgb(0, 0, 0)
                });
                
                Items.inline = Library:Create( "Frame" , {
                    Parent = Items.SatValPicker;
                    Name = "\0";
                    Position = dim2(0, 1, 0, 1);
                    BorderColor3 = rgb(0, 0, 0);
                    Size = dim2(1, -2, 1, -2);
                    BorderSizePixel = 0;
                    BackgroundColor3 = rgb(255, 255, 255)
                });
                
                Items.Saturation = Library:Create( "Frame" , {
                    Parent = Items.Inner;
                    Name = "\0";
                    Size = dim2(1, 0, 1, 0);
                    BorderColor3 = rgb(0, 0, 0);
                    ZIndex = 2;
                    BorderSizePixel = 0;
                    BackgroundColor3 = rgb(255, 255, 255)
                });
                
                Library:Create( "UIGradient" , {
                    Rotation = 270;
                    Transparency = numseq{numkey(0, 0), numkey(1, 1)};
                    Parent = Items.Saturation;
                    Color = rgbseq{rgbkey(0, rgb(0, 0, 0)), rgbkey(1, rgb(0, 0, 0))}
                });
                
                Items.HexTextbox = Library:Create( "Frame" , {
                    AnchorPoint = vec2(0, 1);
                    Parent = Items.Pallete;
                    Name = "\0";
                    Position = dim2(0, 1, 1, 0);
                    BorderColor3 = rgb(0, 0, 0);
                    Size = dim2(1, -39, 0, 18);
                    BorderSizePixel = 0;
                    BackgroundColor3 = rgb(0, 0, 0)
                });
                
                Items.Inline = Library:Create( "Frame" , {
                    Parent = Items.HexTextbox;
                    Name = "\0";
                    Position = dim2(0, 1, 0, 1);
                    BorderColor3 = rgb(0, 0, 0);
                    Size = dim2(1, -2, 1, -2);
                    BorderSizePixel = 0;
                    BackgroundColor3 = themes.preset.inline
                });	Library:Themify(Items.Inline, "inline", "BackgroundColor3")
                
                Items.Background = Library:Create( "Frame" , {
                    Parent = Items.Inline;
                    Name = "\0";
                    Position = dim2(0, 1, 0, 1);
                    BorderColor3 = rgb(0, 0, 0);
                    Size = dim2(1, -2, 1, -2);
                    BorderSizePixel = 0;
                    BackgroundColor3 = themes.preset.background
                });	Library:Themify(Items.Background, "background", "BackgroundColor3")
                
                Items.AlphaInput = Library:Create( "TextBox" , {
                    Font = Enum.Font.Code;
                    Parent = Items.Background;
                    TextColor3 = rgb(239, 239, 239);
                    BorderColor3 = rgb(0, 0, 0);
                    Text = "255, 255, 255, 0.5";
                    Name = "\0";
                    ClearTextOnFocus = false;
                    Size = dim2(1, 0, 1, 0);
                    Selectable = false;
                    BorderSizePixel = 0;
                    BackgroundTransparency = 1;
                    TextXAlignment = Enum.TextXAlignment.Left;
                    Active = false;
                    AutomaticSize = Enum.AutomaticSize.XY;
                    TextSize = 14;
                    BackgroundColor3 = rgb(255, 255, 255)
                });
                
                Items.HueTextbox = Library:Create( "Frame" , {
                    AnchorPoint = vec2(0, 1);
                    Parent = Items.Pallete;
                    Name = "\0";
                    Position = dim2(0, 1, 1, -22);
                    BorderColor3 = rgb(0, 0, 0);
                    Size = dim2(1, -39, 0, 18);
                    BorderSizePixel = 0;
                    BackgroundColor3 = rgb(0, 0, 0)
                });
                
                Items.Inline = Library:Create( "Frame" , {
                    Parent = Items.HueTextbox;
                    Name = "\0";
                    Position = dim2(0, 1, 0, 1);
                    BorderColor3 = rgb(0, 0, 0);
                    Size = dim2(1, -2, 1, -2);
                    BorderSizePixel = 0;
                    BackgroundColor3 = themes.preset.inline
                });	Library:Themify(Items.Inline, "inline", "BackgroundColor3")
                
                Items.Background = Library:Create( "Frame" , {
                    Parent = Items.Inline;
                    Name = "\0";
                    Position = dim2(0, 1, 0, 1);
                    BorderColor3 = rgb(0, 0, 0);
                    Size = dim2(1, -2, 1, -2);
                    BorderSizePixel = 0;
                    BackgroundColor3 = themes.preset.background
                });	Library:Themify(Items.Background, "background", "BackgroundColor3")
                
                Items.RGBInput = Library:Create( "TextBox" , {
                    Font = Enum.Font.Code;
                    Parent = Items.Background;
                    TextColor3 = rgb(239, 239, 239);
                    BorderColor3 = rgb(0, 0, 0);
                    Text = "255, 255, 255, 0.5";
                    Name = "\0";
                    Size = dim2(1, 0, 1, 0);
                    Selectable = false;
                    ClearTextOnFocus = false;
                    BorderSizePixel = 0;
                    BackgroundTransparency = 1;
                    Active = false;
                    TextXAlignment = Enum.TextXAlignment.Left;
                    AutomaticSize = Enum.AutomaticSize.XY;
                    TextSize = 14;
                    BackgroundColor3 = rgb(255, 255, 255)
                });
                
                Items.Alpha = Library:Create( "TextButton" , {
                    Active = false;
                    BorderColor3 = rgb(0, 0, 0);
                    Text = "";
                    AutoButtonColor = false;
                    AnchorPoint = vec2(1, 1);
                    Parent = Items.Pallete;
                    Name = "\0";
                    Position = dim2(1, 2, 1, 0);
                    Size = dim2(0, 16, 1, 0);
                    Selectable = false;
                    BorderSizePixel = 0;
                    BackgroundColor3 = rgb(0, 0, 0)
                });
                
                Items.Inline = Library:Create( "Frame" , {
                    Parent = Items.Alpha;
                    Name = "\0";
                    Position = dim2(0, 1, 0, 1);
                    BorderColor3 = rgb(0, 0, 0);
                    Size = dim2(1, -2, 1, -2);
                    BorderSizePixel = 0;
                    BackgroundColor3 = themes.preset.inline
                });	Library:Themify(Items.Inline, "inline", "BackgroundColor3")
                
                Items.Background = Library:Create( "Frame" , {
                    Parent = Items.Inline;
                    Name = "\0";
                    Position = dim2(0, 1, 0, 1);
                    BorderColor3 = rgb(0, 0, 0);
                    Size = dim2(1, -2, 1, -2);
                    BorderSizePixel = 0;
                    BackgroundColor3 = rgb(255, 255, 255)
                });
                
                Library:Create( "UIGradient" , {
                    Rotation = 90;
                    Parent = Items.Background;
                    Color = rgbseq{rgbkey(0, rgb(255, 255, 255)), rgbkey(1, rgb(9, 9, 9))}
                });
                
                Items.AlphaPicker = Library:Create( "Frame" , {
                    Parent = Items.Background;
                    Name = "\0";
                    BorderMode = Enum.BorderMode.Inset;
                    BorderColor3 = rgb(0, 0, 0);
                    Size = dim2(1, 2, 0, 3);
                    Position = dim2(0, -1, 0, -1);
                    BackgroundColor3 = rgb(255, 255, 255)
                });
                
                Items.RGB = Library:Create( "TextButton" , {
                    Active = false;
                    BorderColor3 = rgb(0, 0, 0);
                    Text = "";
                    AutoButtonColor = false;
                    AnchorPoint = vec2(1, 1);
                    Parent = Items.Pallete;
                    Name = "\0";
                    Position = dim2(1, -18, 1, 0);
                    Size = dim2(0, 16, 1, 0);
                    Selectable = false;
                    BorderSizePixel = 0;
                    BackgroundColor3 = rgb(0, 0, 0)
                });
                
                Items.Inline = Library:Create( "Frame" , {
                    Parent = Items.RGB;
                    Name = "\0";
                    Position = dim2(0, 1, 0, 1);
                    BorderColor3 = rgb(0, 0, 0);
                    Size = dim2(1, -2, 1, -2);
                    BorderSizePixel = 0;
                    BackgroundColor3 = themes.preset.inline
                });	Library:Themify(Items.Inline, "inline", "BackgroundColor3")
                
                Items.hue_drag = Library:Create( "Frame" , {
                    Parent = Items.Inline;
                    Name = "\0";
                    Position = dim2(0, 1, 0, 1);
                    BorderColor3 = rgb(0, 0, 0);
                    Size = dim2(1, -2, 1, -2);
                    BorderSizePixel = 0;
                    BackgroundColor3 = rgb(255, 255, 255)
                });
                
                Library:Create( "UIGradient" , {
                    Rotation = 90;
                    Parent = Items.hue_drag;
                    Color = rgbseq{rgbkey(0, rgb(255, 0, 0)), rgbkey(0.17, rgb(255, 255, 0)), rgbkey(0.33, rgb(0, 255, 0)), rgbkey(0.5, rgb(0, 255, 255)), rgbkey(0.67, rgb(0, 0, 255)), rgbkey(0.83, rgb(255, 0, 255)), rgbkey(1, rgb(255, 0, 0))}
                });
                
                Items.HuePicker = Library:Create( "Frame" , {
                    Parent = Items.hue_drag;
                    Name = "\0";
                    BorderMode = Enum.BorderMode.Inset;
                    BorderColor3 = rgb(0, 0, 0);
                    Size = dim2(1, 2, 0, 3);
                    Position = dim2(0, -1, 0, -1);
                    BackgroundColor3 = rgb(255, 255, 255)
                });
                
                Library:Create( "UIPadding" , {
                    PaddingTop = dim(0, 2);
                    PaddingBottom = dim(0, 3);
                    Parent = Items.Pallete;
                    PaddingRight = dim(0, 3);
                    PaddingLeft = dim(0, 2)
                });
            end;
            
            function Cfg.SetVisible(bool)
                Items.Fade.BackgroundTransparency = 0 
                Library:Tween(Items.Fade, {BackgroundTransparency = 1})

                Items.Window.Visible = bool
                Items.Window.Parent = bool and Library.Items or Library.Other
                Items.Window.Position = dim2(0, Items.Button.AbsolutePosition.X + 2, 0, Items.Button.AbsolutePosition.Y + 74)
            end
            
            function Cfg.Set(color, alpha)
                if type(color) == "boolean" then 
                    return
                end 

                if color then 
                    h, s, v = color:ToHSV()
                end
                
                if alpha then 
                    a = alpha
                end 
                
                local Color = hsv(h, s, v)

                Items.SatValPicker.Position = dim2(s, 0, 1 - v, 0)
                Items.AlphaPicker.Position = dim2(0, -1, a, -1)
                Items.HuePicker.Position = dim2(0, -1, h, -1)
                
                Items.ButtonColor.BackgroundColor3 = hsv(h,s,v)
                Items.Inner.BackgroundColor3 = hsv(h,1,1)

                Flags[Cfg.Flag] = {
                    Color = Color;
                    Transparency = a 
                }
                
                local Color = Items.ButtonColor.BackgroundColor3
                Items.RGBInput.Text = string.format("%s, %s, %s, ", Library:Round(Color.R * 255), Library:Round(Color.G * 255), Library:Round(Color.B * 255))
                Items.RGBInput.Text ..= Library:Round(1 - a, 0.01)
                
                Items.AlphaInput.Text = Library:ConvertHex(Color, 1 - a)

                Cfg.Callback(Color, a)
            end

            function Cfg.UpdateColor() 
                local Mouse = InputService:GetMouseLocation()
                local offset = vec2(Mouse.X, Mouse.Y - gui_offset) 
                
                if DraggingSat then	
                    s = math.clamp((offset - Items.Val.AbsolutePosition).X / Items.Val.AbsoluteSize.X, 0, 1)
                    v = 1 - math.clamp((offset - Items.Val.AbsolutePosition).Y / Items.Val.AbsoluteSize.Y, 0, 1)
                elseif DraggingHue then
                    h = math.clamp((offset - Items.RGB.AbsolutePosition).Y / Items.RGB.AbsoluteSize.Y, 0, 1)
                elseif DraggingAlpha then
                    a = math.clamp((offset - Items.Alpha.AbsolutePosition).Y / Items.Alpha.AbsoluteSize.Y, 0, 1)
                end

                Cfg.Set()
            end

            Items.Button.MouseButton1Click:Connect(function()
                Cfg.Open = not Cfg.Open
                Cfg.SetVisible(Cfg.Open)            
            end)

            InputService.InputChanged:Connect(function(input)
                if (DraggingSat or DraggingHue or DraggingAlpha) and input.UserInputType == Enum.UserInputType.MouseMovement then
                    Cfg.UpdateColor() 
                end
            end)

            Library:Connection(InputService.InputEnded, function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 then
                    DraggingSat = false
                    DraggingHue = false
                    DraggingAlpha = false

                    if not Library:Hovering({Items.Button, Items.Window}) then
                        Cfg.SetVisible(false)
                        Cfg.Open = false
                    end 
                end
            end)    

            Library:Connection(InputService.InputBegan, function(input, game_event)
                if input.UserInputType == Enum.UserInputType.MouseButton1 then
                    if not Library:Hovering({Items.Button, Items.Window}) then
                        Cfg.SetVisible(false)
                        Cfg.Open = false
                    end 
                end 
            end)

            Items.Alpha.MouseButton1Down:Connect(function()
                DraggingAlpha = true 
            end)
            
            Items.RGB.MouseButton1Down:Connect(function()
                DraggingHue = true 
            end)
            
            Items.Val.MouseButton1Down:Connect(function()
                DraggingSat = true  
            end)

            Items.RGBInput.FocusLost:Connect(function()
                local text = Items.RGBInput.Text
                local r, g, b, a = Library:Convert(text)
                
                if r and g and b and a then 
                    Cfg.Set(rgb(r, g, b), 1 - a)
                end 
            end)

            Items.AlphaInput.FocusLost:Connect(function()
                local Color, Alpha = Library:ConvertFromHex(Items.AlphaInput.Text)
                Cfg.Set(Color, 1 - Alpha)
            end)

            Cfg.Set(Cfg.Color, Cfg.Alpha)
            ConfigFlags[Cfg.Flag] = Cfg.Set

            return setmetatable(Cfg, Library)
        end 

        -- =========================
        -- Config System (full rewrite)
        -- =========================

        local ConfigHolder = nil

        function Library:GetConfig()
            local Config = {}

            for Flag, Value in Flags do
                if type(Value) == "table" then
                    if Value.Color and Value.Transparency ~= nil then
                        -- Colorpicker
                        Config[Flag] = {
                            type = "color",
                            color = Value.Color:ToHex(),
                            transparency = Value.Transparency,
                        }
                    elseif Value.mode ~= nil or Value.key ~= nil then
                        -- Keybind (stored lowercase from Keybind:Set)
                        local key = Value.key
                        local keyStr = "NONE"
                        if key and tostring(key) ~= "Enums" and key ~= "NONE" then
                            keyStr = tostring(key)
                                :gsub("Enum%.KeyCode%.", "")
                                :gsub("Enum%.UserInputType%.", "")
                        end
                        Config[Flag] = {
                            type   = "keybind",
                            mode   = Value.mode or "Toggle",
                            key    = keyStr,
                            active = Value.active or false,
                        }
                    else
                        -- Generic table (multi-dropdown etc)
                        Config[Flag] = { type = "table", value = Value }
                    end
                elseif type(Value) == "boolean" then
                    Config[Flag] = { type = "boolean", value = Value }
                elseif type(Value) == "number" then
                    Config[Flag] = { type = "number", value = Value }
                elseif type(Value) == "string" then
                    Config[Flag] = { type = "string", value = Value }
                end
            end

            return HttpService:JSONEncode(Config)
        end

        function Library:LoadConfig(JSON)
            local ok, Config = pcall(function()
                return HttpService:JSONDecode(JSON)
            end)

            if not ok or type(Config) ~= "table" then
                Notifications:Create({ Name = "Failed to parse config file." })
                return
            end

            for Flag, Data in Config do
                if Flag == "config_name_list" then continue end
                if type(Data) ~= "table" then continue end

                local Function = ConfigFlags[Flag]
                if not Function then continue end

                local t = Data.type

                local ok2, err = pcall(function()
                    if t == "color" then
                        local c = Color3.fromHex(Data.color)
                        Function(c, Data.transparency or 0)

                    elseif t == "keybind" then
                        local resolvedKey = "NONE"
                        if Data.key and Data.key ~= "NONE" and Data.key ~= "" then
                            -- Try KeyCode first, then UserInputType
                            local enumVal = nil
                            pcall(function() enumVal = Enum.KeyCode[Data.key] end)
                            if not enumVal then
                                pcall(function() enumVal = Enum.UserInputType[Data.key] end)
                            end
                            resolvedKey = enumVal or "NONE"
                        end
                        Function({
                            Mode   = Data.mode or "Toggle",
                            Key    = resolvedKey,
                            Active = Data.active or false,
                        })

                    elseif t == "boolean" then
                        Function(Data.value)

                    elseif t == "number" then
                        Function(Data.value)

                    elseif t == "string" then
                        Function(Data.value or "")

                    elseif t == "table" then
                        Function(Data.value)
                    end
                end)

                if not ok2 then
                    warn("[Config] Failed to load flag '" .. tostring(Flag) .. "': " .. tostring(err))
                end
            end
        end

        function Library:UpdateConfigList()
            if not ConfigHolder then return end

            local list = {}
            local ok, files = pcall(listfiles, Library.Directory .. "/configs")
            if not ok then return end

            for _, file in files do
                local name = file
                    :gsub(Library.Directory .. "/configs\\", "")
                    :gsub(Library.Directory .. "\\configs\\", "")
                    :gsub(Library.Directory .. "/configs/", "")
                    :gsub("%.cfg$", "")
                if name ~= "" then
                    table.insert(list, name)
                end
            end

            ConfigHolder.RefreshOptions(list)
        end

        function Library:Round(num, float) 
            local Multiplier = 1 / (float or 1)
            return math.floor(num * Multiplier + 0.5) / Multiplier
        end

        function Library:Themify(instance, theme, property)
            table.insert(themes.utility[theme][property], instance)
        end

        function Library:SaveGradient(instance, theme)
            table.insert(themes.gradients[theme], instance)
        end

        function Library:RefreshTheme(theme, color)
            for property,instances in themes.utility[theme] do 
                for _,object in instances do
                    if object[property] == themes.preset[theme] then 
                        object[property] = color 
                    end
                end 
            end

            themes.preset[theme] = color 
        end 

        function Library:Connection(signal, callback)
            local connection = signal:Connect(callback)
            table.insert(Library.Connections, connection)
            return connection 
        end

        function Library:CloseElement() 
            if not (Library.OpenElement and Library.OpenElement.SetVisible) then 
                return 
            end 

            Library.OpenElement.SetVisible(false)
            Library.OpenElement.Open = false
        end

        function Library:Create(instance, options)
            local ins = Instance.new(instance) 

            for prop, value in options do
                ins[prop] = value
            end

            if ins == "TextButton" then 
                ins["AutoButtonColor"] = false 
                ins["Text"] = ""
            end 
            
            return ins 
        end

        function Library:Unload() 
            if Library.Items then 
                Library.Items:Destroy()
            end

            if Library.Other then 
                Library.Other:Destroy()
            end

            if Library.WatermarkGui then
                Library.WatermarkGui:Destroy()
            end

            if Library.KeybindListGui then
                Library.KeybindListGui:Destroy()
            end
            
            for _,connection in Library.Connections do 
                connection:Disconnect() 
                connection = nil 
            end

            getgenv().Library = nil 
        end
    --
    
    -- Library element functions
        function Library:Window(properties)
            local Cfg = {
                Prefix = properties.Prefix or "OBF";
                Suffix = properties.Suffix or "HUB";
                Size = properties.Size or dim2(0, 620, 0, 471);
                TabInfo;
                Items = {};
            }
            
            Library.Items = Library:Create( "ScreenGui" , {
                Parent = CoreGui;
                Name = "";
                Enabled = true;
                ZIndexBehavior = Enum.ZIndexBehavior.Sibling;
                IgnoreGuiInset = true;
            });
            
            Library.Other = Library:Create( "ScreenGui" , {
                Parent = CoreGui;
                Name = "";
                Enabled = false;
                ZIndexBehavior = Enum.ZIndexBehavior.Sibling;
                IgnoreGuiInset = true;
            }); 

            Library:InitWatermark()
            Library:InitKeybindList()

            local Items = Cfg.Items; do
                Items.Window = Library:Create( "Frame" , {
                    Parent = Library.Items;
                    Name = "\0";
                    Position = dim2(0.5, -Cfg.Size.X.Offset / 2, 0.5, -Cfg.Size.Y.Offset / 2);
                    BorderColor3 = rgb(0, 0, 0);
                    Size = Cfg.Size;
                    BorderSizePixel = 0;
                    BackgroundColor3 = rgb(0, 0, 0)
                }); Items.Window.Position = dim2(0, Items.Window.AbsolutePosition.X, 0, Items.Window.AbsolutePosition.Y); Library:Themify(Items.Window, "window_outline", "BackgroundColor3");
                
                Items.Outline = Library:Create( "Frame" , {
                    Parent = Items.Window;
                    Name = "\0";
                    Size = dim2(1, 0, 1, 0);
                    BorderColor3 = rgb(0, 0, 0);
                    ZIndex = 2;
                    BorderSizePixel = 0;
                    BackgroundColor3 = rgb(0, 0, 0)
                }); Library:Themify(Items.Outline, "window_outline", "BackgroundColor3")
                
                Items.Inline = Library:Create( "Frame" , {
                    Parent = Items.Outline;
                    Name = "\0";
                    Position = dim2(0, 1, 0, 1);
                    BorderColor3 = rgb(0, 0, 0);
                    Size = dim2(1, -2, 1, -2);
                    BorderSizePixel = 0;
                    BackgroundColor3 = themes.preset.inline
                });	Library:Themify(Items.Inline, "inline", "BackgroundColor3")
                
                Items.TabHolderFrame = Library:Create( "Frame" , {
                    Parent = Items.Inline;
                    Name = "\0";
                    Position = dim2(0, 1, 0, 1);
                    BorderColor3 = rgb(0, 0, 0);
                    Size = dim2(0, 139, 1, -2);
                    BorderSizePixel = 0;
                    BackgroundColor3 = rgb(12, 14, 14)
                });
                
                Items.Filler = Library:Create( "Frame" , {
                    Parent = Items.TabHolderFrame;
                    Name = "\0";
                    Position = dim2(1, -1, 0, 0);
                    BorderColor3 = rgb(0, 0, 0);
                    Size = dim2(0, 1, 1, 0);
                    BorderSizePixel = 0;
                    BackgroundColor3 = themes.preset.inline
                });	Library:Themify(Items.Filler, "inline", "BackgroundColor3")
                
                Items.TabHolder = Library:Create( "Frame" , {
                    Parent = Items.TabHolderFrame;
                    BackgroundTransparency = 1;
                    Name = "\0";
                    BorderColor3 = rgb(0, 0, 0);
                    Size = dim2(1, 0, 1, 0);
                    BorderSizePixel = 0;
                    BackgroundColor3 = rgb(255, 255, 255)
                });	
                
                Library:Create( "UIListLayout" , {
                    Parent = Items.TabHolder;
                    Padding = dim(0, 6);
                    SortOrder = Enum.SortOrder.LayoutOrder
                });
                
                Library:Create( "UIPadding" , {
                    Parent = Items.TabHolder;
                    PaddingTop = dim(0, 6)
                });
                
                Items.PageHolder = Library:Create( "Frame" , {
                    Parent = Items.Inline;
                    Name = "\0";
                    Position = dim2(0, 140, 0, 1);
                    BorderColor3 = rgb(0, 0, 0);
                    Size = dim2(1, -141, 1, -2);
                    BorderSizePixel = 0;
                    BackgroundColor3 = themes.preset.background
                });	Library:Themify(Items.PageHolder, "background", "BackgroundColor3")

                Library:AddStars(Items.PageHolder, {
                    Count = 110,
                    MinSize = 1,
                    MaxSize = 2,
                    MinSpeed = 8,
                    MaxSpeed = 26,
                    MinAlpha = 0.10,
                    MaxAlpha = 0.70,
                    TwinkleSpeed = 2.2,
                    Color = Color3.fromRGB(255, 0, 242)
                })

                Items.TitleHolder = Library:Create( "Frame" , {
                    Parent = Items.PageHolder;
                    BackgroundTransparency = 1;
                    Name = "\0";
                    BorderColor3 = rgb(0, 0, 0);
                    Size = dim2(1, 0, 0, 43);
                    BorderSizePixel = 0;
                    BackgroundColor3 = rgb(255, 255, 255)
                });	
                
                Items.Filler = Library:Create( "Frame" , {
                    Parent = Items.TitleHolder;
                    Name = "\0";
                    Position = dim2(0, 0, 1, -1);
                    BorderColor3 = rgb(0, 0, 0);
                    Size = dim2(1, 0, 0, 1);
                    BorderSizePixel = 0;
                    BackgroundColor3 = themes.preset.inline
                });	Library:Themify(Items.Filler, "inline", "BackgroundColor3")
                
                Items.SectionTitle = Library:Create( "TextLabel" , {
                    RichText = true;
                    Parent = Items.TitleHolder;
                    TextColor3 = themes.preset.accent;
                    BorderColor3 = rgb(0, 0, 0);
                    Text = '<font color = "rgb(255,255,255)">' .. Cfg.Prefix .. '</font> ' .. Cfg.Suffix .. '';
                    Name = "\0";
                    AutomaticSize = Enum.AutomaticSize.XY;
                    AnchorPoint = vec2(0, 0.5);
                    BorderSizePixel = 0;
                    BackgroundTransparency = 1;
                    Position = dim2(0, 0, 0.5, 0);
                    Font = Enum.Font.Code;
                    ZIndex = 2;
                    TextSize = 20;
                    BackgroundColor3 = rgb(255, 255, 255)
                }); Library:Themify(Items.SectionTitle, "accent", "TextColor3")
                
                Library:Create( "UIPadding" , {
                    Parent = Items.SectionTitle;
                    PaddingRight = dim(0, 8);
                    PaddingLeft = dim(0, 13)
                });
                
                Items.Pages = Library:Create( "Frame" , {
                    Parent = Items.PageHolder;
                    Name = "\0";
                    BackgroundTransparency = 1;
                    Position = dim2(0, 0, 0, 43);
                    BorderColor3 = rgb(0, 0, 0);
                    Size = dim2(1, 0, 1, -43);
                    BorderSizePixel = 0;
                    BackgroundColor3 = rgb(255, 255, 255)
                });	

                Items.Fade = Library:Create( "Frame" , {
                    Name = "\0";
                    BackgroundTransparency = 1;
                    Parent = Items.Pages;
                    BorderColor3 = rgb(0, 0, 0);
                    Size = dim2(1, 0, 1, 0);
                    BorderSizePixel = 0;
                    BackgroundColor3 = rgb(17, 19, 19);
                    ZIndex = 2;
                });	Library:Themify(Items.Fade, "background", "BackgroundColor3")                
                
                Items.Glow = Library:Create( "ImageLabel" , {
                    ImageColor3 = rgb(255, 0, 242);
                    ScaleType = Enum.ScaleType.Slice;
                    ImageTransparency = 0.6499999761581421;
                    BorderColor3 = rgb(0, 0, 0);
                    Parent = Items.Window;
                    Name = "\0";
                    Size = dim2(1, 40, 1, 40);
                    Image = "rbxassetid://18245826428";
                    BackgroundTransparency = 1;
                    Position = dim2(0, -20, 0, -20);
                    BackgroundColor3 = rgb(255, 255, 255);
                    BorderSizePixel = 0;
                    SliceCenter = rect(vec2(21, 21), vec2(79, 79))
                });	Library:Themify(Items.Glow, "glow", "ImageColor3")                
            end

            do
                Library:Draggify(Items.Window)
                Library:Resizify(Items.Window)
            end

            function Cfg.ToggleMenu(bool) 
                if Cfg.Tweening then 
                    return 
                end 

                Cfg.Tweening = true 

                Items.Window.Visible = true

                local Children = Items.Window:GetDescendants()
                table.insert(Children, Items.Window)

                local Tween;
                for _,obj in Children do
                    local Index = Library:GetTransparency(obj)

                    if not Index then 
                        continue 
                    end

                    if type(Index) == "table" then
                        for _,prop in Index do
                            Tween = Library:Fade(obj, prop, bool)
                        end
                    else
                        Tween = Library:Fade(obj, Index, bool)
                    end
                end

                Library:Connection(Tween.Completed, function()
                    task.wait()
                    Cfg.Tweening = false
                    Items.Window.Visible = bool
                end)
            end 

            function Cfg.ChangeMenuTitle(text)
                Items.UITitle.Text = text
            end

            function Cfg.ToggleKeybindList(bool)
                Library:SetKeybindListVisible(bool)
            end
            
            return setmetatable(Cfg, Library)
        end 

        function Library:Tab(properties)
            local Cfg = {
                Name = properties.name or properties.Name or "visuals"; 
                Icon = properties.Icon or properties.icon or "rbxassetid://112730572155522";
                Items = {};
            }

            local Items = Cfg.Items; do 
                Items.Button = Library:Create( "TextButton" , {
                    Active = false;
                    BorderColor3 = rgb(0, 0, 0);
                    Text = "";
                    AutoButtonColor = false;
                    Parent = self.Items.TabHolder;
                    BackgroundTransparency = 1;
                    Name = "\0";
                    Size = dim2(1, 0, 0, 30);
                    Selectable = false;
                    BorderSizePixel = 0;
                    BackgroundColor3 = rgb(255, 255, 255)
                });
                
                Items.Holder = Library:Create( "Frame" , {
                    Parent = Items.Button;
                    Name = "\0";
                    BackgroundTransparency = 1;
                    Position = dim2(0, 6, 0, 0);
                    BorderColor3 = rgb(0, 0, 0);
                    Size = dim2(1, -13, 1, 0);
                    BorderSizePixel = 0;
                    BackgroundColor3 = themes.preset.visible_backgrounds
                });	Library:Themify(Items.Holder, "visible_backgrounds", "BackgroundColor3")
                
                Items.Icon = Library:Create( "ImageLabel" , {
                    ImageColor3 = themes.preset.deselected;
                    BorderColor3 = rgb(0, 0, 0);
                    Parent = Items.Holder;
                    Name = "\0";
                    AnchorPoint = vec2(0, 0.5);
                    Image = Cfg.Icon;
                    BackgroundTransparency = 1;
                    Position = dim2(0, 8, 0.5, 0);
                    Size = dim2(0, 14, 0, 14);
                    BorderSizePixel = 0;
                    BackgroundColor3 = rgb(255, 255, 255)
                });	Library:Themify(Items.Icon, "deselected", "ImageColor3"); Library:Themify(Items.Icon, "accent", "ImageColor3")
                
                Items.SectionTitle = Library:Create( "TextLabel" , {
                    Font = Enum.Font.Code;
                    TextColor3 = themes.preset.deselected;
                    BorderColor3 = rgb(0, 0, 0);
                    Text = Cfg.Name;
                    Parent = Items.Holder;
                    Name = "\0";
                    AnchorPoint = vec2(0, 0.5);
                    AutomaticSize = Enum.AutomaticSize.XY;
                    BackgroundTransparency = 1;
                    Position = dim2(0, 22, 0.5, 0);
                    BorderSizePixel = 0;
                    ZIndex = 2;
                    TextSize = 14;
                    BackgroundColor3 = rgb(12, 14, 14)
                });	Library:Themify(Items.SectionTitle, "text_color", "TextColor3") Library:Themify(Items.SectionTitle, "deselected", "TextColor3") 
                Items.SectionTitle.TextColor3 = themes.preset.deselected;
                Library:Create( "UIPadding" , {
                    Parent = Items.SectionTitle;
                    PaddingRight = dim(0, 8);
                    PaddingLeft = dim(0, 8)
                });
                
                Items.Indicator = Library:Create( "ImageLabel" , {
                    ImageColor3 = themes.preset.accent;
                    ImageTransparency = 1;
                    BackgroundTransparency = 1;
                    BorderColor3 = rgb(0, 0, 0);
                    Parent = Items.Button;
                    AnchorPoint = vec2(0, 0.5);
                    Image = "rbxassetid://126397903791071";
                    Name = "\0";
                    Position = dim2(0, 0, 0.5, 0);
                    Size = dim2(0, 2, 0, 19);
                    BorderSizePixel = 0;
                    BackgroundColor3 = rgb(255, 255, 255)
                });	Library:Themify(Items.Indicator, "accent", "ImageColor3")                

                Items.Pages = Library:Create( "Frame" , {
                    Parent = Library.Other;
                    Visible = false;
                    BackgroundTransparency = 1;
                    Name = "\0";
                    BorderColor3 = rgb(0, 0, 0);
                    Size = dim2(1, 0, 1, 0);
                    BorderSizePixel = 0;
                    BackgroundColor3 = rgb(255, 255, 255)
                });
                
                Library:Create( "UIListLayout" , {
                    FillDirection = Enum.FillDirection.Horizontal;
                    HorizontalFlex = Enum.UIFlexAlignment.Fill;
                    Parent = Items.Pages;
                    Padding = dim(0, 6);
                    SortOrder = Enum.SortOrder.LayoutOrder;
                    VerticalFlex = Enum.UIFlexAlignment.Fill
                });
                
                Library:Create( "UIPadding" , {
                    PaddingTop = dim(0, 6);
                    PaddingBottom = dim(0, 6);
                    Parent = Items.Pages;
                    PaddingRight = dim(0, 6);
                    PaddingLeft = dim(0, 6)
                });
                
                Items.Left = Library:Create( "ScrollingFrame" , {
                    ScrollBarImageColor3 = rgb(0, 0, 0);
                    Active = true;
                    AutomaticCanvasSize = Enum.AutomaticSize.Y;
                    ScrollBarThickness = 0;
                    Parent = Items.Pages;
                    Name = "\0";
                    BackgroundTransparency = 1;
                    Size = dim2(0, 100, 0, 100);
                    BackgroundColor3 = rgb(255, 255, 255);
                    BorderColor3 = rgb(0, 0, 0);
                    BorderSizePixel = 0;
                    CanvasSize = dim2(0, 0, 0, 0)
                });
                
                Library:Create( "UIListLayout" , {
                    Parent = Items.Left;
                    Padding = dim(0, 6);
                    SortOrder = Enum.SortOrder.LayoutOrder;
                    HorizontalFlex = Enum.UIFlexAlignment.Fill
                });
                
                Items.Right = Library:Create( "ScrollingFrame" , {
                    ScrollBarImageColor3 = rgb(0, 0, 0);
                    Active = true;
                    AutomaticCanvasSize = Enum.AutomaticSize.Y;
                    ScrollBarThickness = 0;
                    Parent = Items.Pages;
                    Name = "\0";
                    BackgroundTransparency = 1;
                    Size = dim2(0, 100, 0, 100);
                    BackgroundColor3 = rgb(255, 255, 255);
                    BorderColor3 = rgb(0, 0, 0);
                    BorderSizePixel = 0;
                    CanvasSize = dim2(0, 0, 0, 0)
                });
                
                Library:Create( "UIListLayout" , {
                    Parent = Items.Right;
                    Padding = dim(0, 6);
                    SortOrder = Enum.SortOrder.LayoutOrder;
                    HorizontalFlex = Enum.UIFlexAlignment.Fill
                });                
            end 

            function Cfg.OpenTab() 
                local Tab = self.TabInfo
                
                if Tab then
                    Library:Tween(Tab.Indicator, {ImageTransparency = 1})
                    Library:Tween(Tab.Holder, {BackgroundTransparency = 1})
                    Library:Tween(Tab.Icon, {ImageColor3 = themes.preset.deselected})
                    Library:Tween(Tab.SectionTitle, {TextColor3 = themes.preset.deselected})

                    Tab.Pages.Visible = false
                    Tab.Pages.Parent = Library.Other
                end

                self.Items.Fade.BackgroundTransparency = 0 
                Library:Tween(self.Items.Fade, {BackgroundTransparency = 1})

                Library:Tween(Items.Indicator, {ImageTransparency = 0})
                Library:Tween(Items.Holder, {BackgroundTransparency = 0})
                Library:Tween(Items.Icon, {ImageColor3 = themes.preset.accent})
                Library:Tween(Items.SectionTitle, {TextColor3 = themes.preset.text_color})

                Items.Pages.Parent = self.Items.Pages;
                Items.Pages.Visible = true
                
                self.TabInfo = Cfg.Items
            end

            Items.Button.MouseButton1Down:Connect(function()
                Cfg.OpenTab()
            end)

            if not self.TabInfo then
                Cfg.OpenTab()
            end

            return setmetatable(Cfg, Library)
        end

        function Library:Section(properties)
            local Cfg = {
                Name = properties.name or properties.Name or "Section"; 
                Side = properties.side or properties.Side or "Left";
                Items = {};
            };
            
            local Items = Cfg.Items; do
                Items.Section = Library:Create( "Frame" , {
                    Parent = self.Items[ Cfg.Side ];
                    Name = "\0";
                    Size = dim2(0, 0, 0, 0);
                    BorderColor3 = rgb(0, 0, 0);
                    BorderSizePixel = 0;
                    AutomaticSize = Enum.AutomaticSize.Y;
                    BackgroundColor3 = themes.preset.inline
                });	Library:Themify(Items.Section, "inline", "BackgroundColor3")
                
                Items.Inline = Library:Create( "Frame" , {
                    Parent = Items.Section;
                    Size = dim2(1, -2, 1, -2);
                    Name = "\0";
                    Position = dim2(0, 1, 0, 1);
                    BorderColor3 = rgb(0, 0, 0);
                    BorderSizePixel = 0;
                    AutomaticSize = Enum.AutomaticSize.Y;
                    BackgroundColor3 = themes.preset.visible_backgrounds
                });	Library:Themify(Items.Inline, "visible_backgrounds", "BackgroundColor3")
                
                Items.SectionTitle = Library:Create( "TextLabel" , {
                    Font = Enum.Font.Code;
                    TextColor3 = rgb(145, 145, 145);
                    BorderColor3 = rgb(0, 0, 0);
                    Text = Cfg.Name;
                    Parent = Items.Inline;
                    Name = "\0";
                    AutomaticSize = Enum.AutomaticSize.XY;
                    BackgroundTransparency = 1;
                    Position = dim2(0, 0, 0, 6);
                    BorderSizePixel = 0;
                    ZIndex = 2;
                    TextSize = 14;
                    BackgroundColor3 = rgb(255, 255, 255)
                });
                
                Library:Create( "UIPadding" , {
                    Parent = Items.SectionTitle;
                    PaddingRight = dim(0, 8);
                    PaddingLeft = dim(0, 6)
                });
                
                Items.Fill = Library:Create( "Frame" , {
                    Parent = Items.Inline;
                    Name = "\0";
                    Position = dim2(0, 1, 0, 26);
                    BorderColor3 = rgb(0, 0, 0);
                    Size = dim2(1, -2, 0, 1);
                    BorderSizePixel = 0;
                    BackgroundColor3 = themes.preset.inline
                });	Library:Themify(Items.Fill, "inline", "BackgroundColor3")
                
                Items.Elements = Library:Create( "Frame" , {
                    BorderColor3 = rgb(0, 0, 0);
                    Parent = Items.Inline;
                    Name = "\0";
                    BackgroundTransparency = 1;
                    Position = dim2(0, 7, 0, 36);
                    Size = dim2(1, -14, 0, 0);
                    BorderSizePixel = 0;
                    AutomaticSize = Enum.AutomaticSize.Y;
                    BackgroundColor3 = rgb(255, 255, 255)
                });
                
                Library:Create( "UIListLayout" , {
                    Parent = Items.Elements;
                    Padding = dim(0, 7);
                    SortOrder = Enum.SortOrder.LayoutOrder
                });
                
                Library:Create( "UIPadding" , {
                    PaddingBottom = dim(0, 15);
                    Parent = Items.Elements
                });
                
                Library:Create( "UIPadding" , {
                    PaddingBottom = dim(0, 2);
                    Parent = Items.Section
                });                
            end;

            return setmetatable(Cfg, Library)
        end  

        function Library:Toggle(properties) 
            local Cfg = {
                Name = properties.Name or "Toggle";
                Flag = properties.Flag or properties.Name or "Toggle";
                Enabled = properties.Default or false;
                Default = properties.Default or false;
                Callback = properties.Callback or properties.callback or function() end;

                Folding = properties.Folding or false;
                Collapsable = properties.Collapsing or true;

                Items = {};
            }

            local Items = Cfg.Items; do 
                Items.Toggle = Library:Create( "TextButton" , {
                    Active = false;
                    TextTransparency = 1;
                    Text = "";
                    Parent = self.Items.Elements;
                    AutoButtonColor = false;
                    Name = "\0";
                    Size = dim2(1, 0, 0, 0);
                    BackgroundTransparency = 1;
                    Selectable = false;
                    BorderSizePixel = 0;
                    BorderColor3 = rgb(0, 0, 0);
                    AutomaticSize = Enum.AutomaticSize.Y;
                    BackgroundColor3 = rgb(255, 255, 255)
                });
                
                Items.Title = Library:Create( "TextLabel" , {
                    Font = Enum.Font.Code;
                    TextColor3 = themes.preset.text_color;
                    BorderColor3 = rgb(0, 0, 0);
                    Text = Cfg.Name;
                    Parent = Items.Toggle;
                    Name = "\0";
                    RichText = true;
                    BackgroundTransparency = 1;
                    AutomaticSize = Enum.AutomaticSize.XY;
                    BorderSizePixel = 0;
                    ZIndex = 2;
                    TextSize = 14;
                    BackgroundColor3 = rgb(255, 255, 255)
                });	Library:Themify(Items.Title, "text_color", "BackgroundColor3")
                
                Items.Components = Library:Create( "Frame" , {
                    Parent = Items.Toggle;
                    Name = "\0";
                    Position = dim2(1, 0, 0, 0);
                    BorderColor3 = rgb(0, 0, 0);
                    Size = dim2(0, 0, 1, 0);
                    BorderSizePixel = 0;
                    BackgroundColor3 = rgb(255, 255, 255)
                });
                
                Library:Create( "UIListLayout" , {
                    FillDirection = Enum.FillDirection.Horizontal;
                    HorizontalAlignment = Enum.HorizontalAlignment.Right;
                    Parent = Items.Components;
                    Padding = dim(0, 7);
                    SortOrder = Enum.SortOrder.LayoutOrder
                });
                
                Items.ToggleComponent = Library:Create( "Frame" , {
                    Name = "\0";
                    Parent = Items.Components;
                    BorderColor3 = rgb(0, 0, 0);
                    Size = dim2(0, 29, 0, 14);
                    BorderSizePixel = 0;
                    BackgroundColor3 = rgb(26, 28, 28)
                });
                
                Library:Create( "UICorner" , {
                    Parent = Items.ToggleComponent
                });
                
                Items.Inline = Library:Create( "Frame" , {
                    Parent = Items.ToggleComponent;
                    Name = "\0";
                    Position = dim2(0, 1, 0, 1);
                    BorderColor3 = rgb(0, 0, 0);
                    Size = dim2(1, -2, 1, -2);
                    BorderSizePixel = 0;
                    BackgroundColor3 = rgb(24, 24, 27)
                });
                
                Library:Create( "UICorner" , {
                    Parent = Items.Inline
                });
                
                Library:Create( "UIGradient" , {
                    Color = rgbseq{rgbkey(0, rgb(213, 213, 213)), rgbkey(1, rgb(213, 213, 213))};
                    Parent = Items.Inline
                });
                
                Items.Circle = Library:Create( "Frame" , {
                    AnchorPoint = vec2(0, 0.5);
                    Parent = Items.Inline;
                    Name = "\0";
                    Position = dim2(0, 2, 0.5, 0);
                    BorderColor3 = rgb(0, 0, 0);
                    Size = dim2(0, 8, 0, 8);
                    BorderSizePixel = 0;
                    BackgroundColor3 = rgb(68, 68, 69)
                });
                
                Library:Create( "UICorner" , {
                    Parent = Items.Circle;
                    CornerRadius = dim(0, 999)
                });                
            end;
            
            local _toggleInitDone = false
            function Cfg.Set(bool)
                Flags[Cfg.Flag] = bool

                if _toggleInitDone then
                    Cfg.Callback(bool)
                end

                Library:Tween(Items.ToggleComponent, {BackgroundColor3 = bool and themes.preset.accent or themes.preset.inline})
                Library:Tween(Items.Inline, {BackgroundColor3 = bool and themes.preset.accent or themes.preset.background})
                Library:Tween(Items.Circle, {BackgroundColor3 = bool and rgb(255, 255, 255) or themes.preset.deselected, Position = bool and dim2(1, -10, 0.5, 0) or dim2(0, 2, 0.5, 0)})                
            end
            
            Items.Toggle.MouseButton1Click:Connect(function()
                Cfg.Enabled = not Cfg.Enabled
                Cfg.Set(Cfg.Enabled)
            end)

            Cfg.Set(Cfg.Default)
            _toggleInitDone = true

            ConfigFlags[Cfg.Flag] = Cfg.Set

            return setmetatable(Cfg, Library)
        end 
        
        function Library:Slider(properties) 
            local Cfg = {
                Name = properties.Name,
                Suffix = properties.Suffix or "",
                Flag = properties.Flag or properties.Name or "Slider",
                Callback = properties.Callback or function() end, 

                Min = properties.Min or 0,
                Max = properties.Max or 100,
                Intervals = properties.Decimal or 1,
                Value = properties.Default or 10, 

                Dragging = false,
                Items = {}
            } 

            local Items = Cfg.Items; do
                Items.Slider = Library:Create( "Frame" , {
                    Parent = self.Items.Elements;
                    Name = "\0";
                    BackgroundTransparency = 1;
                    Size = dim2(1, 0, 0, 0);
                    BorderColor3 = rgb(0, 0, 0);
                    BorderSizePixel = 0;
                    AutomaticSize = Enum.AutomaticSize.Y;
                    BackgroundColor3 = rgb(255, 255, 255)
                });
                
                Items.Title = Library:Create( "TextLabel" , {
                    Font = Enum.Font.Code;
                    TextColor3 = themes.preset.text_color;
                    BorderColor3 = rgb(0, 0, 0);
                    Text = Cfg.Name;
                    Parent = Items.Slider;
                    Name = "\0";
                    RichText = true;
                    BackgroundTransparency = 1;
                    AutomaticSize = Enum.AutomaticSize.XY;
                    BorderSizePixel = 0;
                    ZIndex = 2;
                    TextSize = 14;
                    BackgroundColor3 = rgb(255, 255, 255)
                });	Library:Themify(Items.Title, "text_color", "BackgroundColor3")
                
                Items.Components = Library:Create( "Frame" , {
                    Parent = Items.Slider;
                    Name = "\0";
                    Position = dim2(1, 0, 0, 0);
                    BorderColor3 = rgb(0, 0, 0);
                    Size = dim2(0, 0, 0, 14);
                    BorderSizePixel = 0;
                    BackgroundColor3 = rgb(255, 255, 255)
                });
                
                Library:Create( "UIListLayout" , {
                    Parent = Items.Components;
                    SortOrder = Enum.SortOrder.LayoutOrder;
                    HorizontalAlignment = Enum.HorizontalAlignment.Right
                });
                
                Items.Value = Library:Create( "TextLabel" , {
                    Font = Enum.Font.Code;
                    TextColor3 = themes.preset.deselected;
                    BorderColor3 = rgb(0, 0, 0);
                    Text = "0.5";
                    Parent = Items.Components;
                    Name = "\0";
                    BackgroundTransparency = 1;
                    AutomaticSize = Enum.AutomaticSize.XY;
                    BorderSizePixel = 0;
                    ZIndex = 2;
                    TextSize = 14;
                    BackgroundColor3 = rgb(255, 255, 255)
                });	Library:Themify(Items.Value, "deselected", "BackgroundColor3")
                
                Items.Outline = Library:Create( "TextButton" , {
                    Active = false;
                    BorderColor3 = rgb(0, 0, 0);
                    Text = "";
                    AutoButtonColor = false;
                    Parent = Items.Slider;
                    Name = "\0";
                    Position = dim2(0, 0, 0, 21);
                    Size = dim2(1, 0, 0, 7);
                    Selectable = false;
                    BorderSizePixel = 0;
                    BackgroundColor3 = rgb(12, 14, 14)
                });
                
                Items.Fill = Library:Create( "Frame" , {
                    Name = "\0";
                    Parent = Items.Outline;
                    BorderColor3 = rgb(0, 0, 0);
                    Size = dim2(0.5, 0, 1, 0);
                    BorderSizePixel = 0;
                    BackgroundColor3 = themes.preset.accent
                });	Library:Themify(Items.Fill, "accent", "BackgroundColor3")
                
                Items.Circle = Library:Create( "Frame" , {
                    AnchorPoint = vec2(0.5, 0.5);
                    Parent = Items.Fill;
                    Name = "\0";
                    Position = dim2(1, 0, 0.5, 0);
                    BorderColor3 = rgb(0, 0, 0);
                    Size = dim2(0, 11, 0, 11);
                    BorderSizePixel = 0;
                    BackgroundColor3 = themes.preset.accent
                });	Library:Themify(Items.Circle, "accent", "BackgroundColor3")
                
                Library:Create( "UICorner" , {
                    Parent = Items.Circle;
                    CornerRadius = dim(0, 999)
                });
            end 

            function Cfg.Set(value)
                Cfg.Value = math.clamp(Library:Round(value, Cfg.Intervals), Cfg.Min, Cfg.Max)

                Items.Fill.Size = dim2((Cfg.Value - Cfg.Min) / (Cfg.Max - Cfg.Min), 0, 1, 0)
                Items.Value.Text = tostring(Cfg.Value) .. Cfg.Suffix

                Flags[Cfg.Flag] = Cfg.Value
                Cfg.Callback(Flags[Cfg.Flag])
            end
            
            Items.Outline.MouseButton1Down:Connect(function()
                Cfg.Dragging = true 
            end)

            Library:Connection(InputService.InputChanged, function(input)
                if Cfg.Dragging and input.UserInputType == Enum.UserInputType.MouseMovement then 
                    local Size = (input.Position.X - Items.Outline.AbsolutePosition.X) / Items.Outline.AbsoluteSize.X
                    local Value = ((Cfg.Max - Cfg.Min) * Size) + Cfg.Min
                    Cfg.Set(Value)
                end
            end)

            Library:Connection(InputService.InputEnded, function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 then
                    Cfg.Dragging = false
                end 
            end)

            Cfg.Set(Cfg.Value)
            ConfigFlags[Cfg.Flag] = Cfg.Set

            return setmetatable(Cfg, Library)
        end 

        function Library:Dropdown(properties) 
            local Cfg = {
                Name = properties.Name or nil;
                Flag = properties.Flag or properties.Name or "Dropdown";
                Options = properties.Options or {""};
                Callback = properties.Callback or function() end;
                Multi = properties.Multi or false;
                Scrolling = properties.Scrolling or false;

                Open = false;
                OptionInstances = {};
                MultiItems = {};
                Items = {};
                Tweening = false;
                Ignore = properties.Ignore or false;
            }   

            Cfg.Default = properties.Default or (Cfg.Multi and {Cfg.Items[1]}) or Cfg.Items[1] or "None"
            Flags[Cfg.Flag] = Cfg.Default
            
            local Items = Cfg.Items; do 
                Items.Dropdown = Library:Create( "Frame" , {
                    Parent = self.Items.Elements;
                    Name = "\0";
                    BackgroundTransparency = 1;
                    Size = dim2(1, 0, 0, 0);
                    BorderColor3 = rgb(0, 0, 0);
                    BorderSizePixel = 0;
                    AutomaticSize = Enum.AutomaticSize.Y;
                    BackgroundColor3 = rgb(255, 255, 255)
                });
                
                Items.Title = Library:Create( "TextLabel" , {
                    Font = Enum.Font.Code;
                    TextColor3 = themes.preset.text_color;
                    BorderColor3 = rgb(0, 0, 0);
                    Text = Cfg.Name;
                    Parent = Items.Dropdown;
                    Name = "\0";
                    BackgroundTransparency = 1;
                    RichText = true;
                    AutomaticSize = Enum.AutomaticSize.XY;
                    BorderSizePixel = 0;
                    ZIndex = 2;
                    TextSize = 14;
                    BackgroundColor3 = rgb(255, 255, 255)
                });	Library:Themify(Items.Title, "text_color", "BackgroundColor3")
                
                Items.Outline = Library:Create( "TextButton" , {
                    Active = false;
                    BorderColor3 = rgb(0, 0, 0);
                    Text = "";
                    AutoButtonColor = false;
                    Parent = Items.Dropdown;
                    Name = "\0";
                    Position = dim2(0, 0, 0, 21);
                    Size = dim2(1, 0, 0, 20);
                    Selectable = false;
                    BorderSizePixel = 0;
                    BackgroundColor3 = themes.preset.inline
                });	Library:Themify(Items.Outline, "inline", "BackgroundColor3")
                
                Items.Inline = Library:Create( "Frame" , {
                    Parent = Items.Outline;
                    Name = "\0";
                    Position = dim2(0, 1, 0, 1);
                    BorderColor3 = rgb(0, 0, 0);
                    Size = dim2(1, -2, 1, -2);
                    BorderSizePixel = 0;
                    BackgroundColor3 = rgb(31, 31, 31)
                });
                
                Items.Arrow = Library:Create( "ImageLabel" , {
                    ImageColor3 = rgb(219, 222, 221);
                    BorderColor3 = rgb(0, 0, 0);
                    Parent = Items.Inline;
                    Name = "\0";
                    AnchorPoint = vec2(0, 0.5);
                    Image = "rbxassetid://70449495580650";
                    BackgroundTransparency = 1;
                    Position = dim2(1, -15, 0.5, 0);
                    Size = dim2(0, 11, 0, 9);
                    BorderSizePixel = 0;
                    BackgroundColor3 = rgb(255, 255, 255)
                });
                
                Items.InnerText = Library:Create( "TextLabel" , {
                    Font = Enum.Font.Code;
                    TextColor3 = themes.preset.text_color;
                    BorderColor3 = rgb(0, 0, 0);
                    Text = "Option1, Option2, Option3";
                    Parent = Items.Inline;
                    Name = "\0";
                    AnchorPoint = vec2(0, 0.5);
                    AutomaticSize = Enum.AutomaticSize.XY;
                    BackgroundTransparency = 1;
                    Position = dim2(0, 4, 0.5, 1);
                    BorderSizePixel = 0;
                    ZIndex = 2;
                    TextSize = 14;
                    BackgroundColor3 = rgb(255, 255, 255)
                });	Library:Themify(Items.InnerText, "text_color", "BackgroundColor3")                

                Items.DropdownElements = Library:Create( "Frame" , {
                    Parent = Library.Other;
                    Size = dim2(0, 211, 0, 20);
                    Name = "\0";
                    Position = dim2(0, 0, 0, 21);
                    BorderColor3 = rgb(0, 0, 0);
                    BorderSizePixel = 0;
                    AutomaticSize = Enum.AutomaticSize.Y;
                    BackgroundColor3 = themes.preset.inline
                });	Library:Themify(Items.DropdownElements, "inline", "BackgroundColor3")
                
                Items.DropdownHolder = Library:Create( "Frame" , {
                    Parent = Items.DropdownElements;
                    Size = dim2(1, -2, 1, -2);
                    Name = "\0";
                    Position = dim2(0, 1, 0, 1);
                    BorderColor3 = rgb(0, 0, 0);
                    BorderSizePixel = 0;
                    AutomaticSize = Enum.AutomaticSize.Y;
                    BackgroundColor3 = rgb(31, 31, 31)
                });
                
                Library:Create( "UIListLayout" , {
                    Parent = Items.DropdownHolder;
                    SortOrder = Enum.SortOrder.LayoutOrder
                });
                
                Library:Create( "UIPadding" , {
                    PaddingBottom = dim(0, 2);
                    Parent = Items.DropdownElements
                });                        
            end 

            function Cfg.RenderOption(text)
                local Button = Library:Create( "TextButton" , {
                    Parent = Items.DropdownHolder;
                    AutoButtonColor = false;
                    Font = Enum.Font.Code;
                    Name = "\0";
                    TextColor3 = themes.preset.deselected;
                    BorderColor3 = rgb(0, 0, 0);
                    Text = text;
                    AutomaticSize = Enum.AutomaticSize.XY;
                    Size = dim2(1, 0, 0, 0);
                    AnchorPoint = vec2(0, 0.5);
                    Position = dim2(0, 4, 0.5, 1);
                    BackgroundTransparency = 1;
                    TextXAlignment = Enum.TextXAlignment.Left;
                    BorderSizePixel = 0;
                    ZIndex = 2;
                    TextSize = 14;
                    BackgroundColor3 = rgb(255, 255, 255)
                });	Library:Themify(Button, "deselected", "TextColor3")
                
                Library:Create( "UIPadding" , {
                    PaddingTop = dim(0, 4);
                    PaddingBottom = dim(0, 4);
                    Parent = Button;
                    PaddingRight = dim(0, 4);
                    PaddingLeft = dim(0, 4)
                });                   

                table.insert(Cfg.OptionInstances, Button)

                return Button
            end
            
            function Cfg.SetVisible(bool)
                Items.DropdownElements.Position = dim2(0, Items.Outline.AbsolutePosition.X, 0, Items.Outline.AbsolutePosition.Y + 80)
				Items.DropdownElements.Size = dim_offset(Items.Outline.AbsoluteSize.X + 1, 0)
                Items.DropdownElements.Visible = bool 
                Items.DropdownElements.Parent = bool and Library.Items or Library.Other

                Library:Tween(Items.Arrow, {Rotation = bool and 180 or 0})
            end
            
            function Cfg.Set(value)
                local Selected = {}
                local IsTable = type(value) == "table"

                for _,option in Cfg.OptionInstances do 
                    if option.Text == value or (IsTable and table.find(value, option.Text)) then 
                        table.insert(Selected, option.Text)
                        Cfg.MultiItems = Selected
                        option.TextColor3 = themes.preset.text_color
                        option.BackgroundTransparency = 0.95
                    else
                        option.TextColor3 = themes.preset.deselected
                        option.BackgroundTransparency = 1
                    end
                end

                Items.InnerText.Text = if IsTable then table.concat(Selected, ", ") else Selected[1] or ""
                Flags[Cfg.Flag] = if IsTable then Selected else Selected[1]
                
                Cfg.Callback(Flags[Cfg.Flag]) 
            end
            
            function Cfg.RefreshOptions(options) 
                for _,option in Cfg.OptionInstances do 
                    option:Destroy() 
                end
                
                Cfg.OptionInstances = {} 

                for _,option in options do
                    local Button = Cfg.RenderOption(option)
                    
                    Button.MouseButton1Down:Connect(function()
                        if Cfg.Multi then 
                            local Selected = table.find(Cfg.MultiItems, Button.Text)
                            
                            if Selected then 
                                table.remove(Cfg.MultiItems, Selected)
                            else
                                table.insert(Cfg.MultiItems, Button.Text)
                            end
                            
                            Cfg.Set(Cfg.MultiItems) 				
                        else 
                            Cfg.SetVisible(false)
                            Cfg.Open = false
                            
                            Cfg.Set(Button.Text)
                        end
                    end)
                end
            end

            Items.Outline.MouseButton1Click:Connect(function()
                Cfg.Open = not Cfg.Open 

                Cfg.SetVisible(Cfg.Open)
            end)

            Library:Connection(InputService.InputBegan, function(input, game_event)
                if input.UserInputType == Enum.UserInputType.MouseButton1 then
                    if not Library:Hovering({Items.DropdownElements, Items.Dropdown}) then
                        Cfg.SetVisible(false)
                        Cfg.Open = false
                    end 
                end 
            end)

            Flags[Cfg.Flag] = {} 
            ConfigFlags[Cfg.Flag] = Cfg.Set
            
            Cfg.RefreshOptions(Cfg.Options)
            Cfg.Set(Cfg.Default)
                
            return setmetatable(Cfg, Library)
        end

        function Library:Label(properties)
            local Cfg = {
                Name = properties.Name or "Label",
                Items = {};
            }

            local Items = Cfg.Items; do 
                Items.Label = Library:Create( "Frame" , {
                    Parent = self.Items.Elements;
                    Name = "\0";
                    BackgroundTransparency = 1;
                    Size = dim2(1, 0, 0, 0);
                    BorderColor3 = rgb(0, 0, 0);
                    BorderSizePixel = 0;
                    AutomaticSize = Enum.AutomaticSize.Y;
                    BackgroundColor3 = rgb(255, 255, 255)
                });
                
                Items.Title = Library:Create( "TextLabel" , {
                    Font = Enum.Font.Code;
                    TextColor3 = themes.preset.text_color;
                    BorderColor3 = rgb(0, 0, 0);
                    Text = Cfg.Name;
                    Parent = Items.Label;
                    Name = "\0";
                    BackgroundTransparency = 1;
                    RichText = true;
                    AutomaticSize = Enum.AutomaticSize.XY;
                    BorderSizePixel = 0;
                    ZIndex = 2;
                    TextSize = 14;
                    BackgroundColor3 = rgb(255, 255, 255)
                });	Library:Themify(Items.Title, "text_color", "BackgroundColor3")
                
                Items.Components = Library:Create( "Frame" , {
                    Parent = Items.Label;
                    Name = "\0";
                    Position = dim2(1, 0, 0, 0);
                    BorderColor3 = rgb(0, 0, 0);
                    Size = dim2(0, 0, 1, 0);
                    BorderSizePixel = 0;
                    BackgroundColor3 = rgb(255, 255, 255)
                });
                
                Library:Create( "UIListLayout" , {
                    FillDirection = Enum.FillDirection.Horizontal;
                    HorizontalAlignment = Enum.HorizontalAlignment.Right;
                    Parent = Items.Components;
                    Padding = dim(0, 7);
                    SortOrder = Enum.SortOrder.LayoutOrder
                });                        
            end 

            function Cfg.Set(Text)
                Items.Title.Text = Text
            end 

            return setmetatable(Cfg, Library)
        end
        
        function Library:Colorpicker(properties) 
            local Cfg = {
                Name = properties.Name or "Color", 
                Flag = properties.Flag or properties.Name or "Colorpicker",
                Callback = properties.Callback or function() end,

                Color = properties.Color or color(1, 1, 1),
                Alpha = properties.Alpha or properties.Transparency or 0,
                
                Open = false;
                Items = {};
            }
            
            local Picker = self:Keypicker(Cfg)

            local Items = Picker.Items; do
                Cfg.Items = Items
                Cfg.Set = Picker.Set
            end;
            
            Cfg.Set(Cfg.Color, Cfg.Alpha)
            ConfigFlags[Cfg.Flag] = Cfg.Set

            return setmetatable(Cfg, Library)
        end 

        function Library:Textbox(properties) 
            local Cfg = {
                Name = properties.Name or "TextBox",
                PlaceHolder = properties.PlaceHolder or properties.PlaceHolderText or properties.Holder or properties.HolderText or "Type here...",
                Default = properties.Default or "",
                Flag = properties.Flag or properties.Name or "TextBox",
                Callback = properties.Callback or function() end,
                
                Items = {};
            }

            Flags[Cfg.Flag] = Cfg.Default

            local Items = Cfg.Items; do 
                Items.Textbox = Library:Create( "Frame" , {
                    Parent = self.Items.Elements;
                    Name = "\0";
                    BackgroundTransparency = 1;
                    Size = dim2(1, 0, 0, 0);
                    BorderColor3 = rgb(0, 0, 0);
                    BorderSizePixel = 0;
                    AutomaticSize = Enum.AutomaticSize.Y;
                    BackgroundColor3 = rgb(255, 255, 255)
                });
                
                Items.Title = Library:Create( "TextLabel" , {
                    Font = Enum.Font.Code;
                    TextColor3 = themes.preset.text_color;
                    BorderColor3 = rgb(0, 0, 0);
                    RichText = true;
                    Text = Cfg.Name;
                    Parent = Items.Textbox;
                    Name = "\0";
                    BackgroundTransparency = 1;
                    AutomaticSize = Enum.AutomaticSize.XY;
                    BorderSizePixel = 0;
                    ZIndex = 2;
                    TextSize = 14;
                    BackgroundColor3 = rgb(255, 255, 255)
                });	Library:Themify(Items.Title, "text_color", "BackgroundColor3")
                
                Items.Outline = Library:Create( "Frame" , {
                    Parent = Items.Textbox;
                    Name = "\0";
                    Position = dim2(0, 0, 0, 21);
                    BorderColor3 = rgb(0, 0, 0);
                    Size = dim2(1, 0, 0, 20);
                    BorderSizePixel = 0;
                    BackgroundColor3 = rgb(26, 28, 28)
                });
                
                Items.Inline = Library:Create( "Frame" , {
                    Parent = Items.Outline;
                    Name = "\0";
                    Position = dim2(0, 1, 0, 1);
                    BorderColor3 = rgb(0, 0, 0);
                    Size = dim2(1, -2, 1, -2);
                    BorderSizePixel = 0;
                    BackgroundColor3 = rgb(31, 31, 31)
                });
                
                Items.Input = Library:Create( "TextBox" , {
                    Parent = Items.Inline;
                    Font = Enum.Font.Code;
                    Name = "\0";
                    Active = false;
                    BorderColor3 = rgb(0, 0, 0);
                    Text = Cfg.Default;
                    Size = dim2(1, 0, 1, 0);
                    Selectable = false;
                    Position = dim2(0, 3, 0, 0);
                    BorderSizePixel = 0;
                    TextTruncate = Enum.TextTruncate.AtEnd;
                    BackgroundTransparency = 1;
                    TextXAlignment = Enum.TextXAlignment.Left;
                    AutomaticSize = Enum.AutomaticSize.XY;
                    TextColor3 = rgb(239, 239, 239);
                    TextSize = 14;
                    BackgroundColor3 = rgb(255, 255, 255)
                });                    
            end 
            
            function Cfg.Set(text) 
                Flags[Cfg.Flag] = text
                Items.Input.Text = text
                Cfg.Callback(text)
            end 
            
            Items.Input:GetPropertyChangedSignal("Text"):Connect(function()
                Flags[Cfg.Flag] = Items.Input.Text
                Cfg.Callback(Items.Input.Text)
            end)

            ConfigFlags[Cfg.Flag] = Cfg.Set

            return setmetatable(Cfg, Library)
        end

        function Library:Keybind(properties) 
            local Cfg = {
                Flag = properties.Flag or properties.Name;
                Callback = properties.Callback or function() end;
                Name = properties.Name or nil; 

                Key = properties.Key or nil;
                Mode = properties.Mode or "Toggle";
                Active = properties.Default or false; 
                
                Open = false;
                Binding;
                Ignore = false;

                Items = {}
            }

            Flags[Cfg.Flag] = {
                mode = Cfg.Mode,
                key = Cfg.Key, 
                active = Cfg.Active
            }

            local Items = Cfg.Items; do 
                Items.KeybindOutline = Library:Create( "TextButton" , {
                    Active = false;
                    LayoutOrder = -1;
                    BorderColor3 = rgb(0, 0, 0);
                    Text = "";
                    AutoButtonColor = false;
                    Parent = self.Items.Components;
                    Name = "\0";
                    Size = dim2(0, 28, 0, 14);
                    Selectable = false;
                    BorderSizePixel = 0;
                    AutomaticSize = Enum.AutomaticSize.X;
                    BackgroundColor3 = rgb(26, 28, 28)
                });
                
                Items.ButtonColor = Library:Create( "Frame" , {
                    Parent = Items.KeybindOutline;
                    Size = dim2(1, -2, 1, -2);
                    Name = "\0";
                    Position = dim2(0, 1, 0, 1);
                    BorderColor3 = rgb(0, 0, 0);
                    BorderSizePixel = 0;
                    AutomaticSize = Enum.AutomaticSize.X;
                    BackgroundColor3 = rgb(31, 31, 31)
                });
                
                Library:Create( "UICorner" , {
                    Parent = Items.ButtonColor;
                    CornerRadius = dim(0, 4)
                });
                
                Items.Key = Library:Create( "TextLabel" , {
                    Font = Enum.Font.Code;
                    TextColor3 = themes.preset.text_color;
                    BorderColor3 = rgb(0, 0, 0);
                    Text = "LSHIFT";
                    Parent = Items.ButtonColor;
                    Name = "\0";
                    TextXAlignment = Enum.TextXAlignment.Center;
                    BackgroundTransparency = 1;
                    AutomaticSize = Enum.AutomaticSize.XY;
                    BorderSizePixel = 0;
                    ZIndex = 2;
                    TextSize = 14;
                    BackgroundColor3 = rgb(255, 255, 255)
                });	Library:Themify(Items.Key, "text_color", "BackgroundColor3")
                
                Library:Create( "UIPadding" , {
                    Parent = Items.Key;
                    PaddingRight = dim(0, 4);
                    PaddingLeft = dim(0, 5);
                    PaddingBottom = dim(0, 2);
                });
                
                Library:Create( "UICorner" , {
                    Parent = Items.KeybindOutline;
                    CornerRadius = dim(0, 4)
                }); 

                Items.ModeHolder = Library:Create( "TextButton" , {
                    Name = "\0";
                    Text = "";
                    AutoButtonColor = false;
                    Position = dim2(0.5217983722686768, 0, 0.47139304876327515, 0);
                    BorderColor3 = rgb(0, 0, 0);
                    Size = dim2(0, 160, 0, 58);
                    Visible = false;
                    Parent = Library.Items;
                    BorderSizePixel = 0;
                    BackgroundColor3 = themes.preset.visible_backgrounds
                });	Library:Themify(Items.ModeHolder, "visible_backgrounds", "BackgroundColor3")
                
                Items.Elements = Library:Create( "Frame" , {
                    BorderColor3 = rgb(0, 0, 0);
                    Parent = Items.ModeHolder;
                    Name = "\0";
                    BackgroundTransparency = 1;
                    Position = dim2(0, 7, 0, 7);
                    Size = dim2(1, -14, 0, 0);
                    BorderSizePixel = 0;
                    AutomaticSize = Enum.AutomaticSize.Y;
                    BackgroundColor3 = rgb(255, 255, 255)
                });
                
                Library:Create( "UIListLayout" , {
                    Parent = Items.Elements;
                    Padding = dim(0, 7);
                    SortOrder = Enum.SortOrder.LayoutOrder
                });
                
                Library:Create( "UIPadding" , {
                    PaddingBottom = dim(0, 15);
                    Parent = Items.Elements
                });
                
                Items.Dropdown = setmetatable(Cfg, Library):Dropdown({Name = "Mode", Options = {"Hold", "Toggle", "Always"}, Flag = Cfg.Flag .. "OPTION_SETTINGS", Callback = function(options)
                    if Cfg.Set then 
                        Cfg.Set(options)
                    end
                end})
            end 

            function Cfg.SetMode(mode) 
                Cfg.Mode = mode 

                if mode == "Always" then
                    Cfg.Set(true)
                elseif mode == "Hold" then
                    Cfg.Set(false)
                end

                Flags[Cfg.Flag].mode = mode
            end

            function Cfg.Set(input)
                if type(input) == "boolean" then 
                    Cfg.Active = input

                    if Cfg.Mode == "Always" then 
                        Cfg.Active = true
                    end
                elseif tostring(input):find("Enum") then 
                    input = input.Name == "Escape" and "NONE" or input
                    Cfg.Key = input or "NONE"	
                elseif table.find({"Toggle", "Hold", "Always"}, input) then 
                    if input == "Always" then 
                        Cfg.Active = true 
                    end 

                    Cfg.Mode = input
                    Cfg.SetMode(Cfg.Mode) 
                elseif type(input) == "table" then
                    -- Handle both uppercase and lowercase key fields from config
                    local rawKey = input.Key or input.key
                    local rawMode = input.Mode or input.mode
                    local rawActive = input.Active or input.active

                    if type(rawKey) == "string" and rawKey ~= "NONE" and rawKey ~= "" then
                        local enumVal = nil
                        pcall(function() enumVal = Enum.KeyCode[rawKey] end)
                        if not enumVal then
                            pcall(function() enumVal = Enum.UserInputType[rawKey] end)
                        end
                        rawKey = enumVal or "NONE"
                    end

                    if rawKey == Enum.KeyCode.Escape then rawKey = "NONE" end

                    Cfg.Key    = rawKey or "NONE"
                    Cfg.Mode   = rawMode or "Toggle"
                    Cfg.Active = rawActive or false

                    Cfg.SetMode(Cfg.Mode) 
                end 

                Cfg.Callback(Cfg.Active)

                local text = (tostring(Cfg.Key) ~= "Enums" and (Keys[Cfg.Key] or tostring(Cfg.Key):gsub("Enum.", "")) or nil)
                local __text = text and tostring(text):gsub("KeyCode.", ""):gsub("UserInputType.", "")

                Items.Key.Text = " " .. (__text or "?") .. " "

                -- Update keybind list
                if Cfg.Flag and not Cfg.Flag:find("OPTION_SETTINGS") and Cfg.Name then
                    local keyHasValue = __text and __text ~= "" and __text ~= "NONE" and tostring(Cfg.Key) ~= "Enums"
                    if keyHasValue then
                        Library:RegisterKeybindRow(Cfg.Flag, Cfg.Name, __text, Cfg.Active)
                    else
                        Library:RemoveKeybindRow(Cfg.Flag)
                    end
                end

                Flags[Cfg.Flag] = {
                    mode   = Cfg.Mode,
                    key    = Cfg.Key, 
                    active = Cfg.Active
                }
            end

            function Cfg.SetVisible(bool)
                Items.ModeHolder.Visible = bool 
                Items.ModeHolder.Position = dim2(0, Items.KeybindOutline.AbsolutePosition.X + 2, 0, Items.KeybindOutline.AbsolutePosition.Y + 74)
            end

            Items.KeybindOutline.MouseButton1Down:Connect(function()
                task.wait()
                Items.Key.Text = " ... "	

                Cfg.Binding = Library:Connection(InputService.InputBegan, function(keycode, game_event)  
                    Cfg.Set(keycode.KeyCode ~= Enum.KeyCode.Unknown and keycode.KeyCode or keycode.UserInputType)
                    
                    Cfg.Binding:Disconnect() 
                    Cfg.Binding = nil
                end)
            end)

            Items.KeybindOutline.MouseButton2Down:Connect(function()
                Cfg.Open = not Cfg.Open 
                Cfg.SetVisible(Cfg.Open)
            end)

            Library:Connection(InputService.InputBegan, function(input, game_event) 
                if input.UserInputType == Enum.UserInputType.MouseButton1 then
                    if not Library:Hovering({Items.ModeHolder, Items.Dropdown.Items.DropdownElements}) then 
                        Items.Dropdown.SetVisible(false)
                        Items.Dropdown.Visible = false

                        Cfg.SetVisible(false)
                        Cfg.Open = false;
                    end 
                end 

                if not game_event then
                    local selected_key = input.UserInputType == Enum.UserInputType.Keyboard and input.KeyCode or input.UserInputType

                    if selected_key == Cfg.Key then 
                        if Cfg.Mode == "Toggle" then 
                            Cfg.Active = not Cfg.Active
                            Cfg.Set(Cfg.Active)
                        elseif Cfg.Mode == "Hold" then 
                            Cfg.Set(true)
                        end
                    end
                end
            end)    

            Library:Connection(InputService.InputEnded, function(input, game_event) 
                if game_event then 
                    return 
                end 

                local selected_key = input.UserInputType == Enum.UserInputType.Keyboard and input.KeyCode or input.UserInputType
    
                if selected_key == Cfg.Key then
                    if Cfg.Mode == "Hold" then 
                        Cfg.Set(false)
                    end
                end
            end)
            
            Cfg.Set({Mode = Cfg.Mode, Active = Cfg.Active, Key = Cfg.Key})           
            ConfigFlags[Cfg.Flag] = Cfg.Set
            Items.Dropdown.Set(Cfg.Mode)

            return setmetatable(Cfg, Library)
        end
        
        function Library:Button(properties) 
            local Cfg = {
                Name = properties.Name or "TextBox",
                Callback = properties.Callback or function() end,
                Items = {};
            }
            
            local Items = Cfg.Items; do 
                Items.Button = Library:Create( "Frame" , {
                    Parent = self.Items.Elements;
                    Name = "\0";
                    BackgroundTransparency = 1;
                    Size = dim2(1, 0, 0, 0);
                    BorderColor3 = rgb(0, 0, 0);
                    BorderSizePixel = 0;
                    AutomaticSize = Enum.AutomaticSize.Y;
                    BackgroundColor3 = rgb(255, 255, 255)
                });
                
                Items.Outline = Library:Create( "TextButton" , {
                    Active = false;
                    BorderColor3 = rgb(0, 0, 0);
                    Text = "";
                    AutoButtonColor = false;
                    Name = "\0";
                    Parent = Items.Button;
                    Size = dim2(1, 0, 0, 20);
                    Selectable = false;
                    BorderSizePixel = 0;
                    BackgroundColor3 = rgb(26, 28, 28)
                });
                
                Items.Inline = Library:Create( "Frame" , {
                    Parent = Items.Outline;
                    Name = "\0";
                    Position = dim2(0, 1, 0, 1);
                    BorderColor3 = rgb(0, 0, 0);
                    Size = dim2(1, -2, 1, -2);
                    BorderSizePixel = 0;
                    BackgroundColor3 = rgb(31, 31, 31)
                });
                
                Items.Title = Library:Create( "TextLabel" , {
                    Font = Enum.Font.Code;
                    TextColor3 = themes.preset.text_color;
                    BorderColor3 = rgb(0, 0, 0);
                    RichText = true;
                    Text = Cfg.Name;
                    Parent = Items.Inline;
                    Name = "\0";
                    AutomaticSize = Enum.AutomaticSize.XY;
                    BackgroundTransparency = 1;
                    Size = dim2(1, 0, 1, 0);
                    BorderSizePixel = 0;
                    ZIndex = 2;
                    TextSize = 14;
                    BackgroundColor3 = rgb(255, 255, 255)
                });	Library:Themify(Items.Title, "text_color", "BackgroundColor3")                                          
            end 

            Items.Outline.MouseButton1Click:Connect(function()
                Items.Title.TextColor3 = rgb(255, 255, 255)
                Library:Tween(Items.Title, {TextColor3 = themes.preset.text_color})
                
                Cfg.Callback()
            end)
            
            return setmetatable(Cfg, Library)
        end

        function Library:ESPPreview(section, ESP)
            local function cfg(...)
                local t = ESP
                local keys = {...}
                for i = 1, #keys - 1 do
                    t = t and t[keys[i]]
                    if t == nil then return nil end
                end
                local v = t and t[keys[#keys]]
                return v
            end
            local function cfgB(default, ...)
                local v = cfg(...)
                if v == nil then return default end
                return v
            end

            local PANEL_H = 220
            local vpRotation = 0

            local container = Library:Create("Frame", {
                Parent              = section.Items.Elements;
                Name                = "\0";
                Size                = dim2(1, 0, 0, PANEL_H);
                BackgroundTransparency = 1;
                BorderSizePixel     = 0;
                ClipsDescendants    = false;
            })

            local viewport = Instance.new("ViewportFrame")
            viewport.Size                   = UDim2.new(1, 0, 1, -20)
            viewport.Position               = UDim2.new(0, 0, 0, 20)
            viewport.BackgroundColor3       = rgb(17, 19, 19)
            viewport.BackgroundTransparency = 0
            viewport.BorderSizePixel        = 0
            viewport.LightDirection         = Vector3.new(-1, -1, -1)
            viewport.Ambient                = Color3.fromRGB(120, 120, 120)
            viewport.LightColor             = Color3.fromRGB(255, 255, 255)
            viewport.ZIndex                 = 1
            viewport.Parent                 = container

            local vpCamera = Instance.new("Camera")
            vpCamera.FieldOfView  = 70
            vpCamera.CameraType   = Enum.CameraType.Track
            vpCamera.CFrame       = CFrame.new(0, 0, 0)
            vpCamera.Focus        = CFrame.new(0, 0, 0)
            vpCamera.Parent       = Workspace
            viewport.CurrentCamera = vpCamera

            local vpChar = nil
            local vpHRP  = nil
            local vpHighlight = nil

            local function cloneChar(c)
                pcall(function()
                    if vpChar then vpChar:Destroy() end
                    vpChar = nil; vpHRP = nil
                    vpHighlight = nil
                    c:WaitForChild("HumanoidRootPart", 5)
                    c.Archivable = true
                    local clone = c:Clone()
                    if not clone then return end
                    pcall(function() clone.Animate:Destroy() end)
                    clone:SetPrimaryPartCFrame(CFrame.new(Vector3.new(0, 1, -6)))
                    clone.Parent = viewport
                    vpCamera.CameraSubject = clone
                    vpChar = clone
                    vpHRP  = clone:FindFirstChild("HumanoidRootPart")

                    local hl = Instance.new("Highlight")
                    hl.FillColor           = ESP.Drawing.Chams.FillRGB or rgb(255,0,242)
                    hl.OutlineColor        = ESP.Drawing.Chams.OutlineRGB or rgb(255,0,242)
                    hl.FillTransparency    = 1
                    hl.OutlineTransparency = 0
                    hl.DepthMode           = Enum.HighlightDepthMode.AlwaysOnTop
                    hl.Enabled             = ESP.Drawing.Chams.Enabled
                    hl.Parent              = clone
                    vpHighlight = hl
                end)
            end

            task.spawn(function()
                cloneChar(lp.Character or lp.CharacterAdded:Wait())
            end)
            lp.CharacterAdded:Connect(cloneChar)

            local overlay = Library:Create("Frame", {
                Parent              = container;
                Position            = dim2(0,0,0,0);
                Size                = dim2(1,0,0,PANEL_H);
                BackgroundTransparency = 1;
                BorderSizePixel     = 0;
                ClipsDescendants    = false;
                ZIndex              = 3;
            })

            do
                local sf = Library:Create("Frame", {
                    Parent=overlay; Size=dim2(1,0,1,0);
                    BackgroundTransparency=1; BorderSizePixel=0; ZIndex=1;
                })
                local rng2 = Random.new()
                local pstars = {}
                for i = 1, 35 do
                    local d = Library:Create("Frame", {
                        Parent=sf;
                        Size=dim2(0,rng2:NextInteger(1,2),0,rng2:NextInteger(1,2));
                        Position=dim2(rng2:NextNumber(0,1),0,rng2:NextNumber(0,1),0);
                        BorderSizePixel=0;
                        BackgroundColor3=rgb(255,0,242);
                        ZIndex=1;
                    })
                    Library:Create("UICorner",{Parent=d;CornerRadius=dim(0,999)})
                    pstars[i]={dot=d;speed=rng2:NextNumber(5,16);baseAlpha=rng2:NextNumber(0.06,0.45);phase=rng2:NextNumber(0,math.pi*2)}
                end
                local pst=0
                Library:Connection(RunService.RenderStepped,function(dt)
                    if not sf or not sf.Parent then return end
                    pst+=dt
                    local abs=sf.AbsoluteSize
                    if abs.X<=0 or abs.Y<=0 then return end
                    for _,s in pstars do
                        local p=s.dot.Position
                        local nx=p.X.Scale+(s.speed*dt)/abs.X
                        local ny=p.Y.Scale+(s.speed*dt)/abs.Y
                        if nx>1.02 then nx=-0.02 end
                        if ny>1.02 then ny=-0.02 end
                        s.dot.Position=UDim2.new(nx,0,ny,0)
                        local tw=math.sin(pst*2.2+s.phase)*0.5+0.5
                        s.dot.BackgroundTransparency=1-math.clamp(s.baseAlpha*(0.55+0.45*tw),0,1)
                    end
                end)
            end

            local boxX, boxY, boxW, boxH = 0, 0, 60, 120
            local THICK = 1

            local fullBox = Library:Create("Frame", {
                Parent              = overlay;
                BackgroundColor3    = rgb(0,0,0);
                BackgroundTransparency = 1;
                BorderSizePixel     = 0;
                ZIndex              = 4;
            })
            local fullBoxStroke = Library:Create("UIStroke", {
                Parent          = fullBox;
                Thickness       = 1;
                Color           = rgb(255,255,255);
                ApplyStrokeMode = Enum.ApplyStrokeMode.Border;
            })
            local boxGradFill = Library:Create("UIGradient", {
                Parent   = fullBox;
                Rotation = -45;
                Enabled  = false;
                Color    = ColorSequence.new{
                    ColorSequenceKeypoint.new(0, rgb(119,120,255));
                    ColorSequenceKeypoint.new(1, rgb(0,0,0));
                };
            })
            local boxGradOutline = Library:Create("UIGradient", {
                Parent  = fullBoxStroke;
                Enabled = false;
                Color   = ColorSequence.new{
                    ColorSequenceKeypoint.new(0, rgb(119,120,255));
                    ColorSequenceKeypoint.new(1, rgb(0,0,0));
                };
            })

            local corners = {}
            for i = 1, 8 do
                corners[i] = Library:Create("Frame", {
                    Parent           = overlay;
                    BackgroundColor3 = rgb(255,255,255);
                    BorderSizePixel  = 0;
                    ZIndex           = 5;
                })
            end

            local hbBg = Library:Create("Frame", {
                Parent           = overlay;
                BackgroundColor3 = rgb(0,0,0);
                BorderSizePixel  = 0;
                ZIndex           = 5;
            })
            local hbFill = Library:Create("Frame", {
                Parent           = hbBg;
                AnchorPoint      = vec2(0,1);
                Position         = dim2(0,0,1,0);
                Size             = dim2(1,0,0.75,0);
                BackgroundColor3 = rgb(255, 255, 255);
                BorderSizePixel  = 0;
                ZIndex           = 6;
            })
            local hbGrad = Library:Create("UIGradient", {
                Parent   = hbFill;
                Rotation = -90;
                Color    = ColorSequence.new{
                    ColorSequenceKeypoint.new(0,   rgb(200,0,0));
                    ColorSequenceKeypoint.new(0.5, rgb(131,1,125));
                    ColorSequenceKeypoint.new(1,   rgb(255,0,242));
                };
            })
            local hbText = Library:Create("TextLabel", {
                Parent              = overlay;
                AnchorPoint         = vec2(0.5,0.5);
                Size                = dim2(0,30,0,12);
                BackgroundTransparency = 1;
                Font                = Enum.Font.Code;
                TextSize            = 10;
                TextColor3          = rgb(242,0,255);
                TextStrokeTransparency = 0;
                TextStrokeColor3    = rgb(0,0,0);
                Text                = "75%";
                ZIndex              = 7;
            })

            local nameLabel = Library:Create("TextLabel", {
                Parent              = overlay;
                AnchorPoint         = vec2(0.5,1);
                Size                = dim2(0,160,0,14);
                BackgroundTransparency = 1;
                Font                = Enum.Font.Code;
                TextSize            = ESP.FontSize or 11;
                TextColor3          = rgb(255,255,255);
                RichText            = true;
                TextStrokeTransparency = 0;
                TextStrokeColor3    = rgb(0,0,0);
                Text                = '(<font color="rgb(255,0,0)">E</font>) ' .. (lp and lp.Name or "Player");
                ZIndex              = 7;
            })

            local distLabel = Library:Create("TextLabel", {
                Parent              = overlay;
                AnchorPoint         = vec2(0.5,0);
                Size                = dim2(0,160,0,14);
                BackgroundTransparency = 1;
                Font                = Enum.Font.Code;
                TextSize            = ESP.FontSize or 11;
                TextColor3          = rgb(255,255,255);
                TextStrokeTransparency = 0;
                TextStrokeColor3    = rgb(0,0,0);
                Text                = "67 meters";
                ZIndex              = 7;
                Visible             = true;
            })
            local weapLabel = Library:Create("TextLabel", {
                Parent              = overlay;
                AnchorPoint         = vec2(0.5,0);
                Size                = dim2(0,160,0,14);
                BackgroundTransparency = 1;
                Font                = Enum.Font.Code;
                TextSize            = ESP.FontSize or 11;
                TextColor3          = rgb(119,120,255);
                TextStrokeTransparency = 0;
                TextStrokeColor3    = rgb(0,0,0);
                Text                = "Weapon";
                ZIndex              = 7;
            })

            local snapLine = Library:Create("Frame", {
                Parent           = overlay;
                AnchorPoint      = vec2(0.5,1);
                BackgroundColor3 = rgb(255,0,242);
                BorderSizePixel  = 0;
                ZIndex           = 3;
            })

            local flag1 = Library:Create("TextLabel", {
                Parent              = overlay;
                AnchorPoint         = vec2(0,0.5);
                Size                = dim2(0,80,0,12);
                BackgroundTransparency = 1;
                Font                = Enum.Font.Code;
                TextSize            = 10;
                TextColor3          = rgb(255,255,255);
                TextXAlignment      = Enum.TextXAlignment.Left;
                TextStrokeTransparency = 0;
                TextStrokeColor3    = rgb(0,0,0);
                Text                = " Admin";
                ZIndex              = 7;
            })

            local rotAngle  = -45
            local lastTickV = tick()

            Library:Connection(RunService.RenderStepped, function(dt)
                if not container or not container.Parent then return end

                if vpChar and vpHRP and vpChar.Parent then
                    vpRotation = vpRotation + 0.5
                    pcall(function()
                        vpChar:SetPrimaryPartCFrame(
                            CFrame.new(Vector3.new(0, 1, -6)) *
                            CFrame.Angles(0, math.rad(vpRotation), 0)
                        )
                    end)
                end

                do
                    local ovW = overlay.AbsoluteSize.X
                    local ovH = overlay.AbsoluteSize.Y
                    if ovW > 0 and ovH > 0 then
                        boxW = math.floor(ovW * 0.50)
                        boxH = math.floor(ovH * 0.78)
                        boxX = math.floor((ovW - boxW) * 0.5)
                        boxY = math.floor(ovH * 0.13)
                    end
                end

                local cx  = boxX + boxW/2
                local cy  = boxY + boxH/2
                local hw  = boxW/2
                local hh  = boxH/2

                local chamsOn = ESP.Drawing.Chams.Enabled
                if vpHighlight then
                    vpHighlight.Enabled = chamsOn
                    if chamsOn then
                        vpHighlight.FillColor    = ESP.Drawing.Chams.FillRGB or rgb(255,0,242)
                        vpHighlight.OutlineColor = ESP.Drawing.Chams.OutlineRGB or rgb(255,0,242)
                        vpHighlight.DepthMode    = Enum.HighlightDepthMode.AlwaysOnTop

                        local fillT    = ESP.Drawing.Chams.Fill_Transparency or 100
                        local outlineT = ESP.Drawing.Chams.Outline_Transparency or 100

                        if ESP.Drawing.Chams.Thermal then
                            local breathe = math.atan(math.sin(tick() * 2)) * 2 / math.pi
                            vpHighlight.FillTransparency    = fillT    * breathe * 0.01
                            vpHighlight.OutlineTransparency = outlineT * breathe * 0.01
                        else
                            vpHighlight.FillTransparency    = fillT    * 0.01
                            vpHighlight.OutlineTransparency = outlineT * 0.01
                        end
                    end
                end

                local snapOn = cfgB(false, "ShowSnapline")
                snapLine.Visible = snapOn
                if snapOn then
                    local ov = overlay.AbsoluteSize
                    local fromY = ov.Y
                    local toY   = boxY + boxH
                    snapLine.Position = dim2(0, cx, 0, toY)
                    snapLine.Size     = dim2(0, 1, 0, fromY - toY)
                    snapLine.BackgroundColor3 = rgb(255,0,242)
                end

                local fullOn = cfgB(true, "Drawing","Boxes","Full","Enabled")
                fullBox.Visible = fullOn
                if fullOn then
                    fullBox.Position = dim2(0, boxX, 0, boxY)
                    fullBox.Size     = dim2(0, boxW, 0, boxH)

                    local gradFillOn = cfgB(true, "Drawing","Boxes","GradientFill")
                    local fillOn     = cfgB(false, "Drawing","Boxes","Filled","Enabled")
                    local fillAlpha  = cfg("Drawing","Boxes","Filled","Transparency") or 0.75

                    if fillOn then
                        if gradFillOn then
                            fullBox.BackgroundColor3 = rgb(255, 255, 255)
                            fullBox.BackgroundTransparency = fillAlpha
                            boxGradFill.Enabled = true
                            boxGradFill.Color = ColorSequence.new{
                                ColorSequenceKeypoint.new(0, cfg("Drawing","Boxes","GradientFillRGB1") or rgb(242,0,255));
                                ColorSequenceKeypoint.new(1, cfg("Drawing","Boxes","GradientFillRGB2") or rgb(0,0,0));
                            }
                        else
                            local fillColor = cfg("Drawing","Boxes","Filled","RGB") or rgb(242,0,255)
                            fullBox.BackgroundColor3 = fillColor
                            fullBox.BackgroundTransparency = fillAlpha
                            boxGradFill.Enabled = false
                        end
                    else
                        fullBox.BackgroundTransparency = 1
                        boxGradFill.Enabled = false
                    end

                    local gradOutlineOn = cfgB(false, "Drawing","Boxes","Gradient")
                    boxGradOutline.Enabled = gradOutlineOn
                    if gradOutlineOn then
                        boxGradOutline.Color = ColorSequence.new{
                            ColorSequenceKeypoint.new(0, cfg("Drawing","Boxes","GradientRGB1") or rgb(119,120,255));
                            ColorSequenceKeypoint.new(1, cfg("Drawing","Boxes","GradientRGB2") or rgb(0,0,0));
                        }
                    end

                    local animate = cfgB(true, "Drawing","Boxes","Animate")
                    if animate then
                        local rotSpeed = cfg("Drawing","Boxes","RotationSpeed") or 300
                        rotAngle = rotAngle + (tick() - lastTickV) * rotSpeed * math.cos(math.pi / 4 * tick() - math.pi / 2)
                        boxGradFill.Rotation    = rotAngle
                        boxGradOutline.Rotation = rotAngle
                    else
                        boxGradFill.Rotation    = -45
                        boxGradOutline.Rotation = -45
                    end
                    lastTickV = tick()

                    local cornersAlsoOn = cfgB(true, "Drawing","Boxes","Corner","Enabled")
                    fullBoxStroke.Enabled = not cornersAlsoOn
                    fullBoxStroke.Color   = cfg("Drawing","Boxes","Full","RGB") or rgb(255,255,255)
                end

                local cornerOn    = cfgB(true,  "Drawing","Boxes","Corner","Enabled")
                local cornerColor = cfg("Drawing","Boxes","Corner","RGB") or rgb(255,255,255)
                local cLX = math.max(3, math.floor(boxW * 0.25))
                local cLY = math.max(3, math.floor(boxH * 0.20))

                local cDefs = {
                    {boxX,        boxY,       cLX,   THICK},
                    {boxX,        boxY,       THICK, cLY},
                    {boxX+boxW-cLX, boxY,     cLX,   THICK},
                    {boxX+boxW-THICK,boxY,    THICK, cLY},
                    {boxX,        boxY+boxH-THICK, cLX, THICK},
                    {boxX,        boxY+boxH-cLY,   THICK,cLY},
                    {boxX+boxW-cLX, boxY+boxH-THICK, cLX, THICK},
                    {boxX+boxW-THICK,boxY+boxH-cLY, THICK,cLY},
                }
                for i, c in cDefs do
                    corners[i].Visible          = cornerOn
                    corners[i].BackgroundColor3 = cornerColor
                    corners[i].Position         = dim2(0, c[1], 0, c[2])
                    corners[i].Size             = dim2(0, c[3], 0, c[4])
                end

                local hbOn  = cfgB(true, "Drawing","Healthbar","Enabled")
                local hbW   = cfg("Drawing","Healthbar","Width") or 2.5
                hbBg.Visible   = hbOn
                hbFill.Visible = hbOn
                if hbOn then
                    local pulse = (math.sin(tick()*0.8)*0.5+0.5)*0.4 + 0.6

                    hbBg.Position = dim2(0, boxX - hbW - 3, 0, boxY)
                    hbBg.Size     = dim2(0, hbW, 0, boxH)

                    hbFill.AnchorPoint = vec2(0, 0)
                    hbFill.Position    = dim2(0, 0, 0, boxH * (1 - pulse))
                    hbFill.Size        = dim2(1, 0, 0, boxH * pulse)

                    local hbGradOn = cfgB(true, "Drawing","Healthbar","Gradient")
                    hbGrad.Enabled = hbGradOn
                    if hbGradOn then
                        hbFill.BackgroundColor3 = rgb(255, 255, 255)
                        hbGrad.Color = ColorSequence.new{
                            ColorSequenceKeypoint.new(0,   cfg("Drawing","Healthbar","GradientRGB3") or rgb(255,0,242));
                            ColorSequenceKeypoint.new(0.5, cfg("Drawing","Healthbar","GradientRGB2") or rgb(131,1,125));
                            ColorSequenceKeypoint.new(1,   cfg("Drawing","Healthbar","GradientRGB1") or rgb(200,0,0));
                        }
                    else
                        hbFill.BackgroundColor3 = rgb(0, 200, 0)
                    end

                    local htOn = cfgB(true, "Drawing","Healthbar","HealthText")
                    hbText.Visible = htOn
                    if htOn then
                        hbText.TextColor3 = cfg("Drawing","Healthbar","HealthTextRGB") or rgb(242,0,255)
                        hbText.Text       = tostring(math.floor(pulse*100)) .. "%"
                        hbText.Position   = dim2(0, boxX - hbW - 3 - 14, 0, boxY + boxH*(1-pulse) + 3)
                    end
                else
                    hbText.Visible = false
                end

                local nameOn  = ESP.Drawing.Names.Enabled
                local distOn  = ESP.Drawing.Distances.Enabled
                local pname   = lp and lp.Name or "Player"
                local distText = distOn and string.format(" [%d]", 67) or ""

                nameLabel.Visible = nameOn
                if nameOn then
                    nameLabel.TextColor3 = ESP.Drawing.Names.RGB or rgb(255,255,255)
                    nameLabel.TextSize   = ESP.FontSize or 11
                    nameLabel.Text = string.format('(<font color="rgb(255,0,0)">E</font>) %s%s', pname, distText)
                    nameLabel.Position = dim2(0, cx, 0, boxY - 9)
                end

                local distPos    = ESP.Drawing.Distances.Position or "Bottom"
                local distBottom = distOn and (distPos == "Bottom")

                distLabel.Visible = distBottom
                if distBottom then
                    distLabel.TextColor3 = ESP.Drawing.Distances.RGB or rgb(255,255,255)
                    distLabel.TextSize   = ESP.FontSize or 11
                    distLabel.Text       = "67 meters"
                    distLabel.Position   = dim2(0, cx, 0, boxY+boxH+3)
                end

                local weapOn = ESP.Drawing.Weapons.Enabled
                weapLabel.Visible = weapOn
                if weapOn then
                    weapLabel.TextColor3 = ESP.Drawing.Weapons.WeaponTextRGB or rgb(119,120,255)
                    weapLabel.TextSize   = ESP.FontSize or 11
                    local yOff = distBottom and (boxY+boxH+9) or (boxY+boxH+3)
                    weapLabel.Position   = dim2(0, cx, 0, yOff)
                end

                local flagOn = cfgB(false, "Drawing","Flags","Enabled")
                flag1.Visible = flagOn
                if flagOn then
                    flag1.Position = dim2(0, boxX+boxW+4, 0, boxY)
                end
            end)
        end

        -- =========================
        -- Configs UI
        -- =========================
        function Library:Configs(window)
            local Tab = window:Tab({ Name = "Settings" })

            -- Configs section
            local Section = Tab:Section({ Name = "Configs", Side = "Left" })

            ConfigHolder = Section:Dropdown({
                Name = "Config List",
                Options = {},
                Flag = "config_name_list",
                Callback = function(option)
                    if option and option ~= "" and option ~= "None" then
                        -- Auto-fill textbox when selecting from dropdown
                        if ConfigFlags["config_Name_text"] then
                            ConfigFlags["config_Name_text"](option)
                        end
                        Flags["config_Name_text"] = option
                    end
                end
            })

            Library:UpdateConfigList()

            Section:Textbox({
                Name = "Config Name",
                Flag = "config_Name_text",
                PlaceHolder = "Enter name...",
                Default = "",
            })

            Section:Button({ Name = "Save", Callback = function()
                local name = Flags["config_Name_text"]
                if not name or name == "" then
                    Notifications:Create({ Name = "Enter a config name first." })
                    return
                end
                local path = Library.Directory .. "/configs/" .. name .. ".cfg"
                local ok, err = pcall(writefile, path, Library:GetConfig())
                if ok then
                    Library:UpdateConfigList()
                    Notifications:Create({ Name = "Saved: " .. name })
                else
                    Notifications:Create({ Name = "Save failed." })
                    warn("[Config] Save error:", err)
                end
            end})

            Section:Button({ Name = "Load", Callback = function()
                local name = Flags["config_Name_text"]
                if not name or name == "" then
                    Notifications:Create({ Name = "Enter a config name first." })
                    return
                end
                local path = Library.Directory .. "/configs/" .. name .. ".cfg"
                local ok, data = pcall(readfile, path)
                if not ok or not data or data == "" then
                    Notifications:Create({ Name = "Config not found: " .. name })
                    return
                end
                Library:LoadConfig(data)
                Library:UpdateConfigList()
                Notifications:Create({ Name = "Loaded: " .. name })
            end})

            Section:Button({ Name = "Delete", Callback = function()
                local name = Flags["config_Name_text"]
                if not name or name == "" then
                    Notifications:Create({ Name = "Enter a config name first." })
                    return
                end
                local path = Library.Directory .. "/configs/" .. name .. ".cfg"
                local ok, err = pcall(delfile, path)
                if ok then
                    Library:UpdateConfigList()
                    Notifications:Create({ Name = "Deleted: " .. name })
                else
                    Notifications:Create({ Name = "Delete failed." })
                    warn("[Config] Delete error:", err)
                end
            end})

            -- Theme section
            local ThemeSection = Tab:Section({ Name = "Theme", Side = "Right" })
            ThemeSection:Label({ Name = "Accent Color" }):Colorpicker({ Flag = "theme_accent", Callback = function(c) Library:RefreshTheme("accent", c) end, Color = themes.preset.accent })
            ThemeSection:Label({ Name = "Window Outline" }):Colorpicker({ Flag = "theme_outline", Callback = function(c) Library:RefreshTheme("window_outline", c) end, Color = themes.preset.window_outline })
            ThemeSection:Label({ Name = "Inline Elements" }):Colorpicker({ Flag = "theme_inline", Callback = function(c) Library:RefreshTheme("inline", c) end, Color = themes.preset.inline })
            ThemeSection:Label({ Name = "Main Background" }):Colorpicker({ Flag = "theme_bg", Callback = function(c) Library:RefreshTheme("background", c) end, Color = themes.preset.background })
            ThemeSection:Label({ Name = "Visible Backgrounds" }):Colorpicker({ Flag = "theme_visbg", Callback = function(c) Library:RefreshTheme("visible_backgrounds", c) end, Color = themes.preset.visible_backgrounds })
            ThemeSection:Label({ Name = "Text Color" }):Colorpicker({ Flag = "theme_text", Callback = function(c) Library:RefreshTheme("text_color", c) end, Color = themes.preset.text_color })
            ThemeSection:Label({ Name = "Glow Effect" }):Colorpicker({ Flag = "theme_glow", Callback = function(c) Library:RefreshTheme("glow", c) end, Color = themes.preset.glow })
            ThemeSection:Label({ Name = "Deselected" }):Colorpicker({ Flag = "theme_desel", Callback = function(c) Library:RefreshTheme("deselected", c) end, Color = themes.preset.deselected })

            window.Tweening = true
            ThemeSection:Label({ Name = "Menu Bind" }):Keybind({
                Name = "Menu Bind",
                Flag = "menu_bind",
                Key = Enum.KeyCode.RightControl,
                Default = true,
                Callback = function(bool)
                    if window.Tweening then return end
                    window.ToggleMenu(bool)
                end
            })
            delay(2, function() window.Tweening = false end)

            ThemeSection:Toggle({
                Name = "Watermark",
                Flag = "watermark_enabled",
                Default = true,
                Callback = function(v) Library:SetWatermarkVisible(v) end
            })

            ThemeSection:Toggle({
                Name = "Keybind List",
                Flag = "keybindlist_enabled",
                Default = true,
                Callback = function(v) Library:SetKeybindListVisible(v) end
            })
        end
    --

    -- Notification Library
        function Notifications:RefreshNotifications() 
            local offset = 50
            
            for i, v in Notifications.Notifs do
                local Position = vec2(20, offset)
                Library:Tween(v, {Position = dim_offset(Position.X, Position.Y)}, TweenInfo.new(1, Enum.EasingStyle.Exponential, Enum.EasingDirection.Out))
                offset += (v.AbsoluteSize.Y + 10)
            end

            return offset
        end
        
        function Notifications:FadeNotifs(path, is_fading)
            local fading = is_fading and 1 or 0 
            
            Library:Tween(path, {BackgroundTransparency = fading}, TweenInfo.new(1, Enum.EasingStyle.Exponential, Enum.EasingDirection.Out))

            for _, instance in path:GetDescendants() do 
                if not instance:IsA("GuiObject") then 
                    if instance:IsA("UIStroke") then
                        Library:Tween(instance, {Transparency = fading}, TweenInfo.new(1, Enum.EasingStyle.Exponential, Enum.EasingDirection.Out))
                    end
        
                    continue
                end 
        
                if instance:IsA("TextLabel") then
                    Library:Tween(instance, {TextTransparency = fading}, TweenInfo.new(1, Enum.EasingStyle.Exponential, Enum.EasingDirection.Out))
                elseif instance:IsA("Frame") then
                    Library:Tween(instance, {BackgroundTransparency = instance.Transparency and 0.6 and is_fading and 1 or 0.6}, TweenInfo.new(1, Enum.EasingStyle.Exponential, Enum.EasingDirection.Out))
                end
            end
        end 
        
        function Notifications:Create(properties)
            local Cfg = {
                Name = properties.Name or "This is a title!";
                Lifetime = properties.LifeTime or 3;
                
                Items = {};
                outline;
            }

            local Items = Cfg.Items; do 
                Items.Outline = Library:Create( "Frame" , {
                    Parent = Library.Items;
                    Name = "\0";
                    Position = dim2(0, 100, 0, 10);
                    BorderColor3 = rgb(0, 0, 0);
                    BorderSizePixel = 0;
                    AutomaticSize = Enum.AutomaticSize.XY;
                    BackgroundColor3 = themes.preset.inline
                });	Library:Themify(Items.Outline, "inline", "BackgroundColor3")
                
                Items.Inline = Library:Create( "Frame" , {
                    Parent = Items.Outline;
                    Name = "\0";
                    Position = dim2(0, 1, 0, 1);
                    BorderColor3 = rgb(0, 0, 0);
                    Size = dim2(1, -2, 1, -2);
                    BorderSizePixel = 0;
                    BackgroundColor3 = themes.preset.visible_backgrounds
                });	Library:Themify(Items.Inline, "visible_backgrounds", "BackgroundColor3")
                
                Library:Create( "UICorner" , {
                    Parent = Items.Inline
                });
                
                Items.Name = Library:Create( "TextLabel" , {
                    Font = Enum.Font.Code;
                    TextColor3 = themes.preset.text_color;
                    BorderColor3 = rgb(0, 0, 0);
                    Text = Cfg.Name;
                    Parent = Items.Inline;
                    Name = "\0";
                    AutomaticSize = Enum.AutomaticSize.XY;
                    BackgroundTransparency = 1;
                    TextXAlignment = Enum.TextXAlignment.Left;
                    BorderSizePixel = 0;
                    ZIndex = 2;
                    TextSize = 14;
                    BackgroundColor3 = rgb(255, 255, 255)
                });	Library:Themify(Items.Name, "text_color", "BackgroundColor3")
                
                Library:Create( "UIPadding" , {
                    PaddingTop = dim(0, 5);
                    PaddingBottom = dim(0, 5);
                    Parent = Items.Name;
                    PaddingRight = dim(0, 5);
                    PaddingLeft = dim(0, 5)
                });
                
                Library:Create( "UICorner" , {
                    Parent = Items.Outline
                });                       
            end 
            
            local index = #Notifications.Notifs + 1
            Notifications.Notifs[index] = Items.Outline
            
            local offset = Notifications:RefreshNotifications()

            Items.Outline.Position = dim_offset(20, offset)

            Library:Tween(Items.Outline, {AnchorPoint = vec2(0, 0)}, TweenInfo.new(1, Enum.EasingStyle.Exponential, Enum.EasingDirection.Out))

            task.spawn(function()
                task.wait(Cfg.Lifetime)
                Notifications.Notifs[index] = nil
                Notifications:FadeNotifs(Items.Outline, true)
                Library:Tween(Items.Outline, {AnchorPoint = vec2(1, 0)}, TweenInfo.new(1, Enum.EasingStyle.Exponential, Enum.EasingDirection.Out))
                task.wait(1)
                Items.Outline:Destroy() 
            end)
        end
